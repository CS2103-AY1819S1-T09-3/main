<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]--><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="Asciidoctor 1.5.6.1"><title>Piconso - Developer Guide</title><link rel="stylesheet" href="stylesheets/gh-pages.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css">
<link rel="stylesheet" href="stylesheets/coderay-asciidoctor.css"></head><body class="article"><div id="site-header"><nav class="navbar navbar-light bg-light"><div class="container"><a class="navbar-brand" href="index.html">Piconso</a><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="UserGuide.html">User Guide</a></li><li class="nav-item"><a class="nav-link active" href="DeveloperGuide.html">Developer Guide</a></li><li class="nav-item"><a class="nav-link" href="LearningOutcomes.html">LOs</a></li><li class="nav-item"><a class="nav-link" href="AboutUs.html">About Us</a></li><li class="nav-item"><a class="nav-link" href="ContactUs.html">Contact Us</a></li><li class="navitem"><a class="nav-link" href="https://cs2103-ay1819s1-t09-3.github.io/main/index.html"><span class="fa fa-github fa-lg" aria-hidden="true"></span>&nbsp;View on GitHub</a></li></ul></div></nav></div><div id="header"><h1>Piconso - Developer Guide</h1></div><div id="content"><div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>By: <code>CS2103-AY1819S1-T09-3</code>      Since: <code>Aug 2018</code>      Licence: <code>MIT</code></p>
</div>
</div>
<div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#setting-up">1. Setting up</a>
<ul class="sectlevel2">
<li><a href="#prerequisites">1.1. Prerequisites</a></li>
<li><a href="#setting-up-the-project-in-your-computer">1.2. Setting up the project in your computer</a></li>
<li><a href="#verifying-the-setup">1.3. Verifying the setup</a></li>
<li><a href="#configurations-to-do-before-writing-code">1.4. Configurations to do before writing code</a></li>
</ul>
</li>
<li><a href="#design">2. Design</a>
<ul class="sectlevel2">
<li><a href="#Design-Architecture">2.1. Architecture</a></li>
<li><a href="#Design-Ui">2.2. UI component</a></li>
<li><a href="#Design-Logic">2.3. Logic component</a></li>
<li><a href="#Design-Model">2.4. Model component</a></li>
<li><a href="#Design-Storage">2.5. Storage component</a></li>
<li><a href="#Design-Commons">2.6. Common classes</a></li>
</ul>
</li>
<li><a href="#implementation">3. Implementation</a>
<ul class="sectlevel2">
<li><a href="#change-directory-cd-feature">3.1. Change Directory (Cd) feature</a></li>
<li><a href="#open-feature">3.2. Open feature</a></li>
<li><a href="#next-prev-feature">3.3. Next/Prev feature</a></li>
<li><a href="#undo-redo-feature">3.4. Undo/Redo feature</a></li>
<li><a href="#transformations-and-imagemagick">3.5. Transformations and ImageMagick</a></li>
<li><a href="#save-feature">3.6. Save feature</a></li>
</ul>
</li>
<li><a href="#implementation-canvas-and-layer-features">4. Implementation: Canvas and Layer features</a>
<ul class="sectlevel2">
<li><a href="#general-overview">4.1. General overview</a></li>
<li><a href="#canvas-canvas-command">4.2. Canvas (canvas) command</a></li>
<li><a href="#layer-layer-commands">4.3. Layer (layer) commands</a></li>
<li><a href="#canvas-and-layers-in-action">4.4. Canvas and Layers in action</a></li>
</ul>
</li>
<li><a href="#implementation-google-features">5. Implementation: Google features</a>
<ul class="sectlevel2">
<li><a href="#overall-introduction">5.1. Overall Introduction</a></li>
<li><a href="#login-login-command">5.2. Login (login) Command</a></li>
<li><a href="#googlelscommand-ls">5.3. GoogleLsCommand (ls)</a></li>
<li><a href="#googledlcommand-dl">5.4. GoogleDlCommand (dl)</a></li>
<li><a href="#googleuploadcommand-ul">5.5. GoogleUploadCommand (ul)</a></li>
</ul>
</li>
<li><a href="#documentation">6. Documentation</a>
<ul class="sectlevel2">
<li><a href="#editing-documentation">6.1. Editing Documentation</a></li>
<li><a href="#publishing-documentation">6.2. Publishing Documentation</a></li>
<li><a href="#converting-documentation-to-pdf-format">6.3. Converting Documentation to PDF format</a></li>
<li><a href="#Docs-SiteWideDocSettings">6.4. Site-wide Documentation Settings</a></li>
<li><a href="#Docs-PerFileDocSettings">6.5. Per-file Documentation Settings</a></li>
<li><a href="#site-template">6.6. Site Template</a></li>
</ul>
</li>
<li><a href="#Testing">7. Testing</a>
<ul class="sectlevel2">
<li><a href="#running-tests">7.1. Running Tests</a></li>
<li><a href="#types-of-tests">7.2. Types of tests</a></li>
<li><a href="#troubleshooting-testing">7.3. Troubleshooting Testing</a></li>
</ul>
</li>
<li><a href="#dev-ops">8. Dev Ops</a>
<ul class="sectlevel2">
<li><a href="#build-automation">8.1. Build Automation</a></li>
<li><a href="#continuous-integration">8.2. Continuous Integration</a></li>
<li><a href="#coverage-reporting">8.3. Coverage Reporting</a></li>
<li><a href="#documentation-previews">8.4. Documentation Previews</a></li>
<li><a href="#making-a-release">8.5. Making a Release</a></li>
<li><a href="#managing-dependencies">8.6. Managing Dependencies</a></li>
</ul>
</li>
<li><a href="#product-scope">Appendix A: Product Scope</a></li>
<li><a href="#user-stories">Appendix B: User Stories</a></li>
<li><a href="#use-cases">Appendix C: Use Cases</a></li>
<li><a href="#non-functional-requirements">Appendix D: Non Functional Requirements</a></li>
<li><a href="#glossary">Appendix E: Glossary</a></li>
<li><a href="#instructions-for-manual-testing">Appendix F: Instructions for Manual Testing</a>
<ul class="sectlevel2">
<li><a href="#launch-and-shutdown">F.1. Launch and Shutdown</a></li>
<li><a href="#changing-a-directory">F.2. Changing a directory</a></li>
<li><a href="#opening-an-image">F.3. Opening an image</a></li>
<li><a href="#traversing-between-image-batches">F.4. Traversing between image batches</a></li>
<li><a href="#applying-transformation-to-image">F.5. Applying transformation to image</a></li>
<li><a href="#applying-raw-transformation-to-image">F.6. Applying raw transformation to image</a></li>
<li><a href="#creating-new-transformation">F.7. Creating new transformation</a></li>
<li><a href="#apply-a-customised-transformation">F.8. Apply a customised transformation</a></li>
<li><a href="#undoing-and-redoing-transformations">F.9. Undoing and Redoing transformations</a></li>
<li><a href="#save-a-image">F.10. Save a image</a></li>
<li><a href="#canvases-and-layers">F.11. Canvases and Layers</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="sect1">
<h2 id="setting-up"><a class="link" href="#setting-up">1. Setting up</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="prerequisites"><a class="link" href="#prerequisites">1.1. Prerequisites</a></h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>JDK <code>9</code></strong> or later</p>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
JDK <code>10</code> on Windows will fail to run tests in <a href="UsingGradle.html#Running-Tests">headless mode</a> due to a <a href="https://github.com/javafxports/openjdk-jfx/issues/66">JavaFX bug</a>.
Windows developers are highly recommended to use JDK <code>9</code>.
</td>
</tr>
</table>
</div>
</li>
<li>
<p><strong>IntelliJ</strong> IDE</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
IntelliJ by default has Gradle and JavaFx plugins installed.<br>
Do not disable them. If you have disabled them, go to <code>File</code> &gt; <code>Settings</code> &gt; <code>Plugins</code> to re-enable them.
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="setting-up-the-project-in-your-computer"><a class="link" href="#setting-up-the-project-in-your-computer">1.2. Setting up the project in your computer</a></h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Fork this repo, and clone the fork to your computer</p>
</li>
<li>
<p>Open IntelliJ (if you are not in the welcome screen, click <code>File</code> &gt; <code>Close Project</code> to close the existing project dialog first)</p>
</li>
<li>
<p>Set up the correct JDK version for Gradle</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Click <code>Configure</code> &gt; <code>Project Defaults</code> &gt; <code>Project Structure</code></p>
</li>
<li>
<p>Click <code>New&#8230;&#8203;</code> and find the directory of the JDK</p>
</li>
</ol>
</div>
</li>
<li>
<p>Click <code>Import Project</code></p>
</li>
<li>
<p>Locate the <code>build.gradle</code> file and select it. Click <code>OK</code></p>
</li>
<li>
<p>Click <code>Open as Project</code></p>
</li>
<li>
<p>Click <code>OK</code> to accept the default settings</p>
</li>
<li>
<p>Open a console and run the command <code>gradlew processResources</code> (Mac/Linux: <code>./gradlew processResources</code>). It should finish with the <code>BUILD SUCCESSFUL</code> message.<br>
This will generate all resources required by the application and tests.<br></p>
</li>
<li>
<p>Open MainWindow.java and other files to check for any code errors<br></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Due to an ongoing issue with some of the newer versions of IntelliJ, code errors may be detected even if the project can be built and run successfully<br></p>
</li>
<li>
<p>To resolve this, place your cursor over any of the code section highlighted in red. Press ALT+ENTER, and select Add '--add-modules=…​' to module compiler options for each error<br></p>
</li>
</ol>
</div>
</li>
<li>
<p>Repeat this for the test folder as well (e.g. check HelpWindowTest.java and other files for code errors, and if so, resolve it the same way)</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="verifying-the-setup"><a class="link" href="#verifying-the-setup">1.3. Verifying the setup</a></h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Run the <code>seedu.address.MainApp</code> and try a few commands</p>
</li>
<li>
<p><a href="#Testing">Run the tests</a> to ensure they all pass.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="configurations-to-do-before-writing-code"><a class="link" href="#configurations-to-do-before-writing-code">1.4. Configurations to do before writing code</a></h3>
<div class="sect3">
<h4 id="configuring-the-coding-style"><a class="link" href="#configuring-the-coding-style">1.4.1. Configuring the coding style</a></h4>
<div class="paragraph">
<p>This project follows <a href="https://github.com/oss-generic/process/blob/master/docs/CodingStandards.adoc">oss-generic coding standards</a>. IntelliJ&#8217;s default style is mostly compliant with ours but it uses a different import order from ours. To rectify,</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Go to <code>File</code> &gt; <code>Settings&#8230;&#8203;</code> (Windows/Linux), or <code>IntelliJ IDEA</code> &gt; <code>Preferences&#8230;&#8203;</code> (macOS)</p>
</li>
<li>
<p>Select <code>Editor</code> &gt; <code>Code Style</code> &gt; <code>Java</code></p>
</li>
<li>
<p>Click on the <code>Imports</code> tab to set the order</p>
<div class="ulist">
<ul>
<li>
<p>For <code>Class count to use import with '*'</code> and <code>Names count to use static import with '*'</code>: Set to <code>999</code> to prevent IntelliJ from contracting the import statements</p>
</li>
<li>
<p>For <code>Import Layout</code>: The order is <code>import static all other imports</code>, <code>import java.*</code>, <code>import javax.*</code>, <code>import org.*</code>, <code>import com.*</code>, <code>import all other imports</code>. Add a <code>&lt;blank line&gt;</code> between each <code>import</code></p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Optionally, you can follow the <a href="UsingCheckstyle.html">UsingCheckstyle.adoc</a> document to configure Intellij to check style-compliance as you write code.</p>
</div>
</div>
<div class="sect3">
<h4 id="getting-started-with-coding"><a class="link" href="#getting-started-with-coding">1.4.2. Getting started with coding</a></h4>
<div class="paragraph">
<p>When you are ready to start coding, get some sense of the overall design by reading <a href="#Design-Architecture">Section 2.1, &#8220;Architecture&#8221;</a>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="design"><a class="link" href="#design">2. Design</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="Design-Architecture"><a class="link" href="#Design-Architecture">2.1. Architecture</a></h3>
<div class="imageblock">
<div class="content">
<img src="images/Architecture.png" alt="Architecture" width="600">
</div>
<div class="title">Figure 1. Architecture Diagram</div>
</div>
<div class="paragraph">
<p>The <strong><em>Architecture Diagram</em></strong> given above explains the high-level design of the App. Given below is a quick overview of each component.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The <code>.pptx</code> files used to create diagrams in this document can be found in the <a href="https://github.com/CS2103-AY1819S1-T09-3/main/docs/diagrams/">diagrams</a> folder. To update a diagram, modify the diagram in the pptx file, select the objects of the diagram, and choose <code>Save as picture</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>Main</code> has only one class called <a href="https://github.com/CS2103-AY1819S1-T09-3/main/src/main/java/seedu/address/MainApp.java"><code>MainApp</code></a>. It is responsible for,</p>
</div>
<div class="ulist">
<ul>
<li>
<p>At app launch: Initializes the components in the correct sequence, and connects them up with each other.</p>
</li>
<li>
<p>At shut down: Shuts down the components and invokes cleanup method where necessary.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="#Design-Commons"><strong><code>Commons</code></strong></a> represents a collection of classes used by multiple other components. Two of those classes play important roles at the architecture level.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>EventsCenter</code> : This class (written using <a href="https://github.com/google/guava/wiki/EventBusExplained">Google&#8217;s Event Bus library</a>) is used by components to communicate with other components using events (i.e. a form of <em>Event Driven</em> design)</p>
</li>
<li>
<p><code>LogsCenter</code> : Used by many classes to write log messages to the App&#8217;s log file.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The rest of the App consists of four components.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#Design-Ui"><strong><code>UI</code></strong></a>: The UI of the App.</p>
</li>
<li>
<p><a href="#Design-Logic"><strong><code>Logic</code></strong></a>: The command executor.</p>
</li>
<li>
<p><a href="#Design-Model"><strong><code>Model</code></strong></a>: Holds the data of the App in-memory.</p>
</li>
<li>
<p><a href="#Design-Storage"><strong><code>Storage</code></strong></a>: Reads data from, and writes data to, the hard disk.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each of the four components</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Defines its <em>API</em> in an <code>interface</code> with the same name as the Component.</p>
</li>
<li>
<p>Exposes its functionality using a <code>{Component Name}Manager</code> class.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, the <code>Logic</code> component (see the class diagram given below) defines it’s API in the <code>Logic.java</code> interface and exposes its functionality using the <code>LogicManager.java</code> class.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/LogicClassDiagram1.png" alt="LogicClassDiagram1" width="800">
</div>
<div class="title">Figure 2. Class Diagram of the Logic Component</div>
</div>
<div class="paragraph">
<p>The sections below give more details of each component.</p>
</div>
</div>
<div class="sect2">
<h3 id="Design-Ui"><a class="link" href="#Design-Ui">2.2. UI component</a></h3>
<div class="imageblock">
<div class="content">
<img src="images/UiClassDiagram_Piconso.png" alt="UiClassDiagram Piconso" width="800">
</div>
<div class="title">Figure 3. Structure of the UI Component</div>
</div>
<div class="paragraph">
<p><strong>API</strong> : <a href="https://github.com/CS2103-AY1819S1-T09-3/main/src/main/java/seedu/address/ui/Ui.java"><code>Ui.java</code></a></p>
</div>
<div class="paragraph">
<p>The UI consists of a <code>MainWindow</code> that is made up of parts e.g.<code>CommandBox</code>, <code>ResultDisplay</code>,
<code>HistoryListPanel</code>, <code>FilmReel</code>, <code>ImagePanel</code> etc. All these, including the <code>MainWindow</code>,
inherit from the abstract <code>UiPart</code> class.</p>
</div>
<div class="paragraph">
<p>The <code>UI</code> component uses JavaFx UI framework. The layout of these UI parts are defined in matching <code>.fxml</code> files that
are in the <code>src/main/resources/view</code> folder. For example, the layout of the <a href="https://github.com/CS2103-AY1819S1-T09-3/main/src/main/java/seedu/address/ui/MainWindow.java"><code>MainWindow</code></a> is specified in <a href="https://github.com/CS2103-AY1819S1-T09-3/main/src/main/resources/view/MainWindow.fxml"><code>MainWindow.fxml</code></a></p>
</div>
<div class="paragraph">
<p>The <code>UI</code> component,</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Executes user commands using the <code>Logic</code> component.</p>
</li>
<li>
<p>Binds itself to some images in the <code>Model</code> so that the UI can auto-update when data in the <code>Model</code> change.</p>
</li>
<li>
<p>Responds to events raised from various parts of the App and updates the UI accordingly.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="Design-Logic"><a class="link" href="#Design-Logic">2.3. Logic component</a></h3>
<div class="imageblock">
<div class="content">
<img src="images/LogicClassDiagram1.png" alt="LogicClassDiagram1" width="800">
</div>
<div class="title">Figure 4. Structure of the Logic Component</div>
</div>
<div class="paragraph">
<p><strong>API</strong> :
<a href="https://github.com/CS2103-AY1819S1-T09-3/main/src/main/java/seedu/address/logic/Logic.java"><code>Logic.java</code></a></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>Logic</code> uses the <code>PiconsoParser</code> class to parse the user command.</p>
</li>
<li>
<p>This results in a <code>Command</code> object which is executed by the <code>LogicManager</code>.</p>
</li>
<li>
<p>The command execution can affect the <code>Model</code> (e.g. converting an image) and/or raise events.</p>
</li>
<li>
<p>The result of the command execution is encapsulated as a <code>CommandResult</code> object which is passed back to the <code>Ui</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Given below is the Sequence Diagram for interactions within the Logic component for the execute("cd") API call.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/LogicComponentClassDiagram.png" alt="LogicComponentClassDiagram" width="800">
</div>
<div class="title">Figure 5. Interactions inside the Logic Component for the <code>cd</code> command</div>
</div>
</div>
<div class="sect2">
<h3 id="Design-Model"><a class="link" href="#Design-Model">2.4. Model component</a></h3>
<div class="imageblock">
<div class="content">
<img src="images/ModelClassDiagram_Piconso.png" alt="ModelClassDiagram Piconso" width="800">
</div>
<div class="title">Figure 6. Structure of the Model Component</div>
</div>
<div class="paragraph">
<p><strong>API</strong> : <a href="https://github.com/CS2103-AY1819S1-T09-3/main/src/main/java/seedu/address/model/Model.java"><code>Model.java</code></a></p>
</div>
<div class="paragraph">
<p>The <code>Model</code>,</p>
</div>
<div class="ulist">
<ul>
<li>
<p>stores a <code>UserPref</code> object that represents the user&#8217;s preferences.</p>
</li>
<li>
<p>stores the <code>Canvas</code> for the current image.</p>
</li>
<li>
<p>does not depend on any of the other three components.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="Design-Storage"><a class="link" href="#Design-Storage">2.5. Storage component</a></h3>
<div class="imageblock">
<div class="content">
<img src="images/StorageClassDiagram.png" alt="StorageClassDiagram" width="800">
</div>
<div class="title">Figure 7. Structure of the Storage Component</div>
</div>
<div class="paragraph">
<p><strong>API</strong> : <a href="https://github.com/CS2103-AY1819S1-T09-3/main/src/main/java/seedu/address/storage/Storage.java"><code>Storage.java</code></a></p>
</div>
<div class="paragraph">
<p>The <code>Storage</code> component,</p>
</div>
<div class="ulist">
<ul>
<li>
<p>can save <code>UserPref</code> objects in json format and read it back.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="Design-Commons"><a class="link" href="#Design-Commons">2.6. Common classes</a></h3>
<div class="paragraph">
<p>Classes used by multiple components are in the <code>seedu.address.commons</code> package.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="implementation"><a class="link" href="#implementation">3. Implementation</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes some noteworthy details on how certain features are implemented.</p>
</div>
<div class="sect2">
<h3 id="change-directory-cd-feature"><a class="link" href="#change-directory-cd-feature">3.1. Change Directory (Cd) feature</a></h3>
<div class="paragraph">
<p>The Cd feature is implemented to allow users to access images in the different directories within their home system.
This removes the restrictions of accessing only images from one particular folder.</p>
</div>
<div class="sect3">
<h4 id="current-implementation"><a class="link" href="#current-implementation">3.1.1. Current Implementation</a></h4>
<div class="paragraph">
<p>The Cd mechanism is facilitated by the <code>ModelManager</code>. It contains the operations <code>Model#getCurrDirectory()</code> and
<code>Model#updateCurrDirectory(Path)</code>.</p>
</div>
<div class="paragraph">
<p>The Model calls upon <code>UserPrefs</code> within the respective operations. The <code>UserPrefs</code> class contains the current directory
the user&#8217;s in, stored internally as <code>currDirectory</code> and implements the following operations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>UserPrefs#getCurrDirectory()</code> - Returns the user&#8217;s current directory.</p>
</li>
<li>
<p><code>UserPrefs#updateUserPrefs(Path)</code> - Updates the user&#8217;s current directory with the updated Path.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Within the operation <code>UserPrefs#updateUserPrefs(Path)</code>, it also retrieves the list of images within the directory,
which are stored internally as <code>imageList</code>. This would facilitate the <code>open</code> feature in our application
(refer to 3.2).</p>
</div>
<div class="paragraph">
<p>Additionally, to ease user&#8217;s experience, similar to the actual usage of the cd command, this feature also uses the <code>tab</code>
function to auto-complete the directory name if it exists.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Pressing tab again will display the next directory with the given prefix.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Given below is an example usage scenario and how the cd mechanism behaves at each step.</p>
</div>
<div class="paragraph">
<p>Step 1. The user launches the application for the first time. The <code>UserPrefs</code> will be initialized with the <code>currDirectory</code>
as the user&#8217;s home directory.</p>
</div>
<div class="paragraph">
<p>Step 2. The user executes <code>cd Desktop</code> command to navigate into the Desktop directory. The cd command calls
<code>Model#getCurrDirectory()</code> and appends <code>Desktop</code> to the end of the current directory. It then checks if the new Path is
a directory and calls <code>Model#updateCurrDirectory(Path)</code> and updates the new Path in <code>UserPrefs</code> if the check returns true.</p>
</div>
<div class="paragraph">
<p>The following sequence diagram shows how the cd command works:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/CdSequenceDiagram.png" alt="CdSequenceDiagram" width="800">
</div>
<div class="title">Figure 8. Sequence Diagram for CdCommand</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If the <code>newCurrDirectory</code> is not a directory, i.e. <code>isDirectory()</code> returns false, then there is no change in
<code>currDirectory</code> state in <code>UserPrefs</code>. If so, it will return a failure message to the user rather than attempting to update
<code>currDirectory</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="design-considerations"><a class="link" href="#design-considerations">3.1.2. Design Considerations</a></h4>
<div class="paragraph">
<p>This section contains the considerations and alternatives we had when implementing the cd command.</p>
</div>
<div class="sect4">
<h5 id="aspect-how-cd-executes"><a class="link" href="#aspect-how-cd-executes">Aspect: How cd executes</a></h5>
<div class="ulist">
<ul>
<li>
<p><strong>Alternative 1 (current choice)</strong>: Retrieves and updates current directory in <code>UserPrefs</code>.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: Easy to implement and every command can access the current directory.</p>
</li>
<li>
<p>Cons: Appends and checks if path exists after every cd command entered.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Alternative 2</strong> : Stores path that exists in a HashSet.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: Do not need to append and check, and just check if it exists in HashSet.</p>
</li>
<li>
<p>Cons: Does not update existing path if user deletes a directory.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="open-feature"><a class="link" href="#open-feature">3.2. Open feature</a></h3>
<div class="paragraph">
<p>The Open Command allow users to open the images in a batch of 10 images within the directory for image-editing.
This command is further facilitated by the Next/Prev Command.</p>
</div>
<div class="sect3">
<h4 id="current-implementation-2"><a class="link" href="#current-implementation-2">3.2.1. Current Implementation</a></h4>
<div class="paragraph">
<p>The implementation of the Open feature is largely similar to the <code>Cd Command</code>. It is facilitated by the <code>ModelManager</code>
and contains the following operations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Model#getDirectoryImageList()</code> - Retrieves the stored list of images in UserPrefs.</p>
</li>
<li>
<p><code>Model#updateCurrentOriginalImage(Image, Path)</code> - Updates the model with the current image opened.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>Model</code> calls upon <code>UserPrefs</code> to retrieve the <code>imageList</code> of the current
batch. The <code>UserPrefs</code> class implements the following operation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>UserPrefs#getCurrImageListBatch()</code> - Returns the current batch of images.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>Model#updateCurrentOriginalImage(Image, Path)</code> operation stores the path of the opened image and the
<code>PreviewImage</code> instance of it as <code>currOriginalImage</code> and <code>currentPreviewImage</code> within the <code>ModelManager</code>.
Additionally, the operation also creates a canvas and a layer to facilitate the <code>transformation</code> feature. (refer to 3.5)</p>
</div>
<div class="paragraph">
<p>Given below is an example usage scenario and how the open mechanism behaves at each step.</p>
</div>
<div class="paragraph">
<p>Step 1. The user launches the application for the first time. The <code>UserPrefs</code> will be initialized with the <code>currDirectory</code>
as the user&#8217;s home directory.</p>
</div>
<div class="paragraph">
<p>Step 2. The user executes <code>cd Desktop</code> command to navigate into the Desktop directory. The cd command will initialise
the <code>imageList</code> with all the images within Desktop.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/SelectCommand1.png" alt="SelectCommand1" width="800">
</div>
</div>
<div class="paragraph">
<p>Step 3. The user executes <code>open 1</code> command to open the first image in the first batch of 10 images. The open
command calls <code>Model#getDirectoryImageList()</code> to retrieve the first batch of images within Desktop. The first image is
then retrieved and displayed on the GUI.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/OpenCommand2.png" alt="OpenCommand2" width="500">
</div>
</div>
<div class="paragraph">
<p>Step 4. The user then executes <code>open 5</code> command to open the fifth image in the batch of 10 images. The fifth image
is then retrieved similarly and displayed on the GUI.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/OpenCommand3.png" alt="OpenCommand3" width="450">
</div>
</div>
<div class="paragraph">
<p>The following sequence diagram shows how the open command works:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/OpenSequenceDiagram.png" alt="OpenSequenceDiagram" width="800">
</div>
<div class="title">Figure 9. Sequence Diagram for OpenCommand</div>
</div>
</div>
<div class="sect3">
<h4 id="design-considerations-2"><a class="link" href="#design-considerations-2">3.2.2. Design Considerations</a></h4>
<div class="paragraph">
<p>This section contains the considerations and alternatives we had when implementing the open command.</p>
</div>
<div class="sect4">
<h5 id="aspect-how-open-executes"><a class="link" href="#aspect-how-open-executes">Aspect: How open executes</a></h5>
<div class="ulist">
<ul>
<li>
<p><strong>Alternative 1 (current choice)</strong>: Open images within the BATCH_SIZE.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: Users work on a small size of images.</p>
</li>
<li>
<p>Cons: Limited to the batch size.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Alternative 2</strong> : Open images within the <code>imageList</code> size.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: Easy to retrieve images anywhere in the list.</p>
</li>
<li>
<p>Cons: Can be very messy if the <code>imageList</code> size is too large.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="next-prev-feature"><a class="link" href="#next-prev-feature">3.3. Next/Prev feature</a></h3>
<div class="paragraph">
<p><code>NextCommand</code> retrieves the next 10 images in the image list (image list refers to images in the current directory).</p>
</div>
<div class="paragraph">
<p>On the contrary, the <code>PrevCommand</code> retrieves the previous 10 images in the image list.</p>
</div>
<div class="sect3">
<h4 id="current-implementation-3"><a class="link" href="#current-implementation-3">3.3.1. Current Implementation</a></h4>
<div class="paragraph">
<p>The implementation of the Next/Previous feature is similar to the <code>CdCommand</code>. It is facilitated by the <code>ModelManager</code>
and contains the operations: <code>Model#updateImageListNextBatch()</code> and <code>Model#updateImageListPrevBatch()</code>.</p>
</div>
<div class="paragraph">
<p>The <code>Model</code> calls upon <code>UserPrefs</code> which stores and facilitates the retrieval of the current
batch of images using the <code>currBatchPointer</code>. The <code>UserPrefs</code> class implements the following operation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>UserPrefs#updateImageListNextBatch()</code> - Adds the <code>currBatchPointer</code> by 10.</p>
</li>
<li>
<p><code>UserPrefs#updateImageListPrevBatch()</code> - Minus the <code>currBatchPointer</code> by 10.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Given below is an example usage scenario and how the next/previous mechanism behaves at each step.</p>
</div>
<div class="paragraph">
<p>Step 1. The user launches the application for the first time. The <code>UserPrefs</code> will be initialized with the <code>currDirectory</code>
as the user&#8217;s home directory.</p>
</div>
<div class="paragraph">
<p>Step 2. The user executes <code>cd Desktop</code> command to navigate into the Desktop directory. The cd command will initialise
the <code>imageList</code> with all the images within Desktop.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/SelectCommand1.png" alt="SelectCommand1" width="800">
</div>
</div>
<div class="paragraph">
<p>Step 3. The user executes <code>next</code> command to retrieve the next 10 images within Desktop.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/NextPrevCommand2.png" alt="NextPrevCommand2" width="800">
</div>
</div>
<div class="paragraph">
<p>Step 4. The user executes <code>prev</code> command to retrieve the previous 10 images within Desktop.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/NextPrevCommand3.png" alt="NextPrevCommand3" width="800">
</div>
</div>
<div class="paragraph">
<p>The following sequence diagram shows how the next command works:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/NextSequenceDiagram.png" alt="NextSequenceDiagram" width="800">
</div>
<div class="title">Figure 10. Sequence Diagram for NextCommand</div>
</div>
<div class="paragraph">
<p>The following sequence diagram shows how the prev command works:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/PrevSequenceDiagram.png" alt="PrevSequenceDiagram" width="800">
</div>
<div class="title">Figure 11. Sequence Diagram for PrevCommand</div>
</div>
</div>
<div class="sect3">
<h4 id="design-considerations-3"><a class="link" href="#design-considerations-3">3.3.2. Design Considerations</a></h4>
<div class="paragraph">
<p>This section contains the considerations and alternatives we had when implementing the next/prev command.</p>
</div>
<div class="sect4">
<h5 id="aspect-how-next-previous-executes"><a class="link" href="#aspect-how-next-previous-executes">Aspect: How next/previous executes</a></h5>
<div class="ulist">
<ul>
<li>
<p><strong>Alternative 1 (current choice)</strong>: Keeps track of current batch with a pointer.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: Easy to access current batch images.</p>
</li>
<li>
<p>Cons: Efficiency might be lower for directories with many images.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Alternative 2</strong> : Store image batches in array.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: Fast to access next/previous batches.</p>
</li>
<li>
<p>Cons: Harder to handle changes in a batch (e.g. image got deleted) within the array.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="undo-redo-feature"><a class="link" href="#undo-redo-feature">3.4. Undo/Redo feature</a></h3>
<div class="sect3">
<h4 id="current-implementation-4"><a class="link" href="#current-implementation-4">3.4.1. Current Implementation</a></h4>
<div class="paragraph">
<p>The <code>undo/redo</code> works on the <code>currentLayer</code> the user is working on. Each <code>Layer</code> contains a <code>PreviewImage</code> which facilitates the undo/redo mechanism.
The mechanism works by caching the original image and transformed images in a temporary <code>cache</code> folder, and using <code>currentStatePointer</code> as a pointer together with <code>currentSize</code> as an indicator to manage the caching.
Undoing and redoing will shift the <code>currentStatePointer</code> accordingly while each transformation commits the image by writing to the <code>cache</code> folder (purging redundant images if needed).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
To work with multiple layers, each <code>Layer</code> has a single <code>PreviewImage</code> which is initialized with a unique <code>LayerId</code>, so that the <code>PreviewImage</code> can cache its images safely without conflicting image names.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Additionally, it implements the following operations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>PreviewImage#commit()</code> - Writes the newly transformed <code>BufferedImage</code> into the <code>cache</code> folder (purge redundant images if needed).</p>
</li>
<li>
<p><code>PreviewImage#getCurrentPath()</code> - Returns the current state&#8217;s <code>Path</code> in the <code>cache</code> folder for ImageMagick to use.</p>
</li>
<li>
<p><code>PreviewImage#undo()</code> - Shifts the <code>currentStatePointer</code> to the left, pointing to the previous state.</p>
</li>
<li>
<p><code>PreviewImage#redo()</code> - Shifts the <code>currentStatePointer</code> to the right, pointing to a previously undone state.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These operations are exposed in the <code>Model</code> interface as <code>Model#updateCurrentPreviewImage()</code>, <code>Model#undoPreviewImage()</code> and <code>Model#redoPreviewImage()</code>.</p>
</div>
<div class="paragraph">
<p>Given below is an example usage scenario and how the undo/redo mechanism behaves at each step.</p>
</div>
<div class="paragraph">
<p>Step 1. The user opens an image with the <code>open</code> command. The <code>Canvas</code> is initialized with a new <code>Layer</code> which initializes its own <code>PreviewImage</code> with the opened image. The <code>currentStatePointer</code> is pointing to that state.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
A <code>Canvas</code> can already be initialized, meaning this is an additional layer being added. The <code>Layer</code> and <code>PreviewImage</code> gets initialized the same way.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="images/undoRedo1.png" alt="undoRedo1" width="800">
</div>
<div class="title">Figure 12. After opening an image</div>
</div>
<div class="paragraph">
<p>Step 2. The user executes a series of transformations. Each time, the newly transformed <code>BufferedImage</code> is stored by writing it to the <code>cache</code> folder. The <code>currentStatePointer</code> is also incremented. Eg. <code>hue</code>, <code>mirror</code>, <code>blur</code></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If a command fails its execution, it will not call <code>Model#updateCurrentPreviewImage()</code>, so nothing will be cached.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="images/undoRedo2.png" alt="undoRedo2" width="800">
</div>
<div class="title">Figure 13. After executing transformations</div>
</div>
<div class="paragraph">
<p>Step 3. The user wants to undo the previous action by using the <code>undo</code> command. It will call <code>Model#undoPreviewImage()</code> which will shift the <code>currentStatePointer</code> once to the left, pointing it to the previous <code>PreviewImage</code> state. After which, that previously cached <code>BufferedImage</code> will be read and rendered to update the UI&#8217;s preview image pane.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If the <code>currentStatePointer</code> is at index 0, pointing to the initial state, then there are no previous states to restore. The <code>undo</code> command uses <code>Model#canUndoPreviewImage()</code> to check if this is the case. If so, it will return an error to the user rather than attempting to perform the undo.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="images/undoRedo3.png" alt="undoRedo3" width="800">
</div>
<div class="title">Figure 14. After exucuting undo</div>
</div>
<div class="paragraph">
<p>Step 4. The user executes another transformation, which calls <code>Model#updateCurrentPreviewImage</code>. Since the <code>currentStatePointer</code> is not pointing at the end state (<code>currentSize - 1</code>), and the states after the <code>currentStatePointer</code> will not make sense, all states after the pointer will be purged.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/undoRedo4.png" alt="undoRedo4" width="800">
</div>
<div class="title">Figure 15. After comitting and purging redundant states</div>
</div>
<div class="paragraph">
<p>The following sequence diagram shows how the undo operation works:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/undoRedoSequenceDiagram.png" alt="undoRedoSequenceDiagram" width="800">
</div>
<div class="title">Figure 16. Sequence Diagram for Undo/RedoCommand</div>
</div>
<div class="paragraph">
<p>The redo command does the opposite — it calls <code>Model#redoPreviewImage()</code>, which shifts the currentStatePointer once to the right, pointing to the previously undone state.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If the <code>currentStatePointer</code> is at index <code>currentSize - 1</code>, pointing to the <code>PreviewImage&#8217;s</code> last state, then there are no undone states to restore. The <code>redo</code> command uses <code>Model#canRedoPreviewImage()</code> to check if this is the case. If so, it will return an error to the user rather than attempting to perform the redo.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following activity diagram summarizes what happens when a user executes a new transformation:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/undoRedoActivityDiagram.png" alt="undoRedoActivityDiagram" width="800">
</div>
<div class="title">Figure 17. Activity Diagram for performing a new image transformation</div>
</div>
<div class="paragraph">
<p>The following activity diagram summarizes what happens when a user executes the undo command:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/undoRedoActivityDiagram2.png" alt="undoRedoActivityDiagram2" width="800">
</div>
<div class="title">Figure 18. Activity Diagram for using <code>undoCommand</code></div>
</div>
<div class="paragraph">
<p>The following activity diagram summarizes what happens when a user executes the redo command:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/undoRedoActivityDiagram3.png" alt="undoRedoActivityDiagram3" width="800">
</div>
<div class="title">Figure 19. Activity Diagram for using <code>redoCommand</code></div>
</div>
</div>
<div class="sect3">
<h4 id="undo-all-and-redo-all"><a class="link" href="#undo-all-and-redo-all">3.4.2. Undo-all and Redo-all</a></h4>
<div class="paragraph">
<p>The commands <code>undo-all</code> and <code>redo-all</code> follow the same implementation as undo and redo. They provide a convenient way to quickly undo and redo all transformations to the current layer&#8217;s <code>PreviewImage</code> for the user.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>undo-all</code> shifts the <code>PreviewImage&#8217;s</code> pointer to 0, pointing at the original state.</p>
</li>
<li>
<p><code>redo-all</code> shifts the <code>PreviewImage&#8217;s</code> pointer to <code>currentSize - 1</code>, the state with all the applied transformations.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="historylistpanel"><a class="link" href="#historylistpanel">3.4.3. HistoryListPanel</a></h4>
<div class="paragraph">
<p>The HistoryListPanel provides a view for the user to see the history of transformations applied.
Whenever a transformation is done or when a undo/redo command is executed, the <code>Model#refreshHistoryList()</code> is executed which refreshes the <code>HistoryListPanel</code> with a <code>HistoryUpdateEvent</code> containing the current layer&#8217;s <code>PreviewImage&#8217;s</code> list of transformations.
A view of the panel is shown below:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/historyPanel.png" alt="historyPanel" width="200">
</div>
<div class="title">Figure 20. Image of HistoryListPanel</div>
</div>
</div>
<div class="sect3">
<h4 id="design-considerations-4"><a class="link" href="#design-considerations-4">3.4.4. Design Considerations</a></h4>
<div class="sect4">
<h5 id="aspect-how-undo-redo-executes"><a class="link" href="#aspect-how-undo-redo-executes">Aspect: How undo &amp; redo executes</a></h5>
<div class="ulist">
<ul>
<li>
<p><strong>Alternative 1 (current choice):</strong> Saves each newly transformed image (including original).</p>
<div class="ulist">
<ul>
<li>
<p>Pros: Fast execution of undo/redo as only reading the cached file is needed. Easy to implement.</p>
</li>
<li>
<p>Cons: Uses the user’s storage space temporarily for caching.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Alternative 2:</strong> Save only the command, and reverse/reapply transformation for each undo/redo.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: Will not need to use user&#8217;s data storage.</p>
</li>
<li>
<p>Cons: Transformations on images take significantly more time as compared to reading and writing cache. Also, reversing of transformations are not possible for commands like <code>blur</code> and <code>colorspace</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="transformations-and-imagemagick"><a class="link" href="#transformations-and-imagemagick">3.5. Transformations and ImageMagick</a></h3>
<div class="sect3">
<h4 id="current-implementation-5"><a class="link" href="#current-implementation-5">3.5.1. Current Implementation</a></h4>
<div class="paragraph">
<p>The transformation mechanism is facilitated by <a href="https://www.imagemagick.org/script/index.php"><code>ImageMagick</code></a>, an external API Library that helps process the target image by the specified commands given.
The transformation feature mainly consists of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ImageMagicUtil</code>: A class which will check, create, and run the imageMagick executable file</p>
</li>
<li>
<p><code>applyCommand</code>: Applies the specified transformation to the image</p>
</li>
<li>
<p><code>createApplyCommand</code>: Allows users to define their own custom transformation set.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following describes main operations and processes contained in the classes above.</p>
</div>
</div>
<div class="sect3">
<h4 id="imagemagickutil"><a class="link" href="#imagemagickutil">3.5.2. ImageMagickUtil:</a></h4>
<div class="paragraph">
<p>This class is used to provide utility methods to facilitate interoperability with ImageMagick such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>copyOutside()</code>&#8201;&#8212;&#8201;Copies the OS-specific payload for ImageMagick.</p>
</li>
<li>
<p><code>parseOperationArguments()</code>&#8201;&#8212;&#8201;Parse the build in arguments and customised operations, return a list of String passed into process builder.</p>
</li>
<li>
<p><code>processImage()</code>&#8201;&#8212;&#8201;Converts user input to a valid ImageMagick command.</p>
</li>
<li>
<p><code>runProcessBuilder()</code>&#8201;&#8212;&#8201;Given a valid ImageMagick command, runs the command and retrieves the output.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This class is separated from the model and acts as a Util for image editing, whenever editing the image,
a transformation will be passed to the processImage, and it will be parses basing on the command templates
stored in the app, then a list of arguments will be parsed from the transformation and a new process builder will be created
and call the ImageMagick executable file to handle the image processing.</p>
</div>
<div class="paragraph">
<p>When starting the app, methods in ImageMagickUtil will be called to check the environment and prepare the ImageMagick package.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/TransformationActivityDiagram.png" alt="TransformationActivityDiagram" width="800">
</div>
<div class="title">Figure 21. Activity Diagram for Transformation feature with ImageMagick</div>
</div>
<div class="sect4">
<h5 id="design-considerations-5"><a class="link" href="#design-considerations-5">Design Considerations:</a></h5>
<div class="paragraph">
<p>As ImageMagick is an independent portable package and it differs from system to system, in order to make sure that
piconso will be able to work on multiple operating system, it needs to check the current system, choose the correct package
and prepare the suitable environment for using ImageMagick.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="applycommand"><a class="link" href="#applycommand">3.5.3. ApplyCommand:</a></h4>
<div class="paragraph">
<p>This command validates a transformation provided by the user and attempts to add it to the current <code>PreviewImage</code>'s <code>TransformationSet</code>.</p>
</div>
<div class="paragraph">
<p>Given below is an example usage scenario and how the command should behave at each step.</p>
</div>
<div class="paragraph">
<p>Step 1. Upon first running the app, the corresponding zip package containing ImageMagick will be copied out of the jar and unzipped. A temporary folder for ImageMagick output is also created.</p>
</div>
<div class="paragraph">
<p>Step 2. The user opens an image with the <code>open</code> command. The method <code>model.getPreviewImage()</code> will be called to read the appropriate <code>BufferedImage</code> from disk.</p>
</div>
<div class="paragraph">
<p>Step 3. The user enters the command (e.g. <code>apply blur 0x8</code>). The entered command is parsed and the corresponding transformation is created.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If an invalid transformation is provided, a reminder of how to use the command will be given to the user and no ImageMagick command will be run.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Step 4. Call <code>ImageMagick#processImage</code> which is a quasi-factory method that creates an instance of <code>ProcessBuilder</code> which contains the all the necessary information for ImageMagick to apply a transformation to the image,
executes the <code>ProcessBuilder</code> and reads the output back from the temporary folder.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
While normal <code>apply</code> commands will show a useful help message after a failure, an <code>apply raw</code> command cannot provide the same granularity and will return a generic error message.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Step 5. If successful, the transformation that is just executed will be added to the <code>PreviewImage</code>'s <code>TransformationSet</code>.</p>
</div>
<div class="paragraph">
<p>Step 6. The command will then request the UI to update its components, namely the <code>HistoryListPanel</code> and <code>ImagePanel</code> if any transformation was applied.</p>
</div>
<div class="sect4">
<h5 id="design-considerations-6"><a class="link" href="#design-considerations-6">Design Considerations</a></h5>
<div class="ulist">
<ul>
<li>
<p>As the ImageMagick executable file is only able to handle command line input and requires the path of the image to modify,
intermediate images have to be stored in a temp folder first.</p>
</li>
<li>
<p>For senior users, or users who are familiar with ImageMagick, <code>apply raw</code> will provide more flexibility and enable them to do further image editting.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ApplyCommandSequenceDiagram.png" alt="ApplyCommandSequenceDiagram" width="800">
</div>
<div class="title">Figure 22. Sequence Diagram for Apply Command</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="createapplycommand"><a class="link" href="#createapplycommand">3.5.4. CreateApplyCommand:</a></h4>
<div class="paragraph">
<p>This command allows users to create a named set of commands and store in the disk. All transformation sets will first be validated by <code>ImageMagickUtil#parseCustomiseCommand</code>.</p>
</div>
<div class="paragraph">
<p>Given below is an example usage scenario and how the transformation should behave at each step.</p>
</div>
<div class="paragraph">
<p>Step 1. The user sequentially enters the transformations he wants to store, in the form of <code>create [command name] (command|argument)</code>. For example,
<code>create blurgray blur|0x8 colorspace|GRAY</code> will create a new command named 'blurgray'.</p>
</div>
<div class="paragraph">
<p>Step 2. The specified transformations are parsed and checked by the templates stored in the app.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If any of the specified transformations have an invalid name or argument, an error will be thrown.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Step 3. The validated new command will be stored in the json for in the PiconsoCommands folder create when first time run the app.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/CreateTransformationActivityDiagram.png" alt="CreateTransformationActivityDiagram" width="800">
</div>
<div class="title">Figure 23. Activity Diagram for CreateApply Command</div>
</div>
</div>
<div class="sect3">
<h4 id="design-considerations-7"><a class="link" href="#design-considerations-7">3.5.5. Design Considerations</a></h4>
<div class="ulist">
<ul>
<li>
<p>Combination of the transformations are commonly needed in our daily lives. When users design a serious of operations and
plan to apply them to multiple images, or store them for future use, this feature will make the image editing more efficient
and flexible, thus we implemented the create command.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="save-feature"><a class="link" href="#save-feature">3.6. Save feature</a></h3>
<div class="sect3">
<h4 id="current-implementation-6"><a class="link" href="#current-implementation-6">3.6.1. Current Implementation</a></h4>
<div class="paragraph">
<p>The save command saves the current preview image to the same location it was opened in the local drive,
User enters the name of the image and the format of the name will be validated.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>isFormatValid()</code> is to validate the format of the filename user enters</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Given is an example of how to use the command</p>
</div>
<div class="paragraph">
<p>Step 1. Parse the argument entered, if no argument, store to original image.</p>
</div>
<div class="paragraph">
<p>Step 2. If there is an argument, parse the image name user enters, get the name and the format of the filename.</p>
</div>
<div class="paragraph">
<p>Step 3. Check the format of the image as well as the filename entered. If the format is not supported or the filename is already in use,
a reminder will be shown to user and the image will not be saved.</p>
</div>
</div>
<div class="sect3">
<h4 id="design-considerations-8"><a class="link" href="#design-considerations-8">3.6.2. Design Considerations</a></h4>
<div class="ulist">
<ul>
<li>
<p>as there is already an option for user to save to original image, when user specifies a filename, in order to avoid
unintended overwritten of other images, using existing filename is forbidden.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/SaveCommandSequenceDiagram.png" alt="SaveCommandSequenceDiagram" width="800">
</div>
<div class="title">Figure 24. Sequence Diagram for Save Command</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="implementation-canvas-and-layer-features"><a class="link" href="#implementation-canvas-and-layer-features">4. Implementation: Canvas and Layer features</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="general-overview"><a class="link" href="#general-overview">4.1. General overview</a></h3>
<div class="paragraph">
<p>The <code>Canvas</code> and <code>Layer</code> classes serve as a layer of encapsulation for handling one or more instances of <code>PreviewImage</code>.
This is in line with good defensive coding practices and separation of concerns.</p>
</div>
</div>
<div class="sect2">
<h3 id="canvas-canvas-command"><a class="link" href="#canvas-canvas-command">4.2. Canvas (canvas) command</a></h3>
<div class="paragraph">
<p>There are a set of overloaded command types inheriting from <code>CanvasCommand</code>, namely:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>bgcolor</code> - Sets the background colour of the canvas.</p>
</li>
<li>
<p><code>size</code> - Sets the height and the width of the canvas.</p>
</li>
<li>
<p><code>auto-resize</code> - Toggles the auto-resize property of the canvas.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="current-implementation-7"><a class="link" href="#current-implementation-7">4.2.1. Current implementation</a></h4>
<div class="paragraph">
<p>Canvas manages various properties made accessible through the <code>ModelManager</code> class.
Layer order is preserved as it important for image composition.</p>
</div>
<div class="paragraph">
<p>Canvas implements the following accessors and utility functions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>getLayers()</code> - Returns an ordered list of layers which is guaranteed to be neither <code>null</code> or empty.</p>
</li>
<li>
<p><code>getLayerNames()</code> - Returns a list of layer names in order.</p>
</li>
<li>
<p><code>addLayer(PreviewImage, String)</code> - Adds a given <code>PreviewImage</code> into the canvas on its own layer.</p>
</li>
<li>
<p><code>getCurrentLayer()</code> - Returns the current instance of the layer that is being operated on.</p>
</li>
<li>
<p><code>getCurrentLayerIndex()</code> - Returns the index of the current instance of the layer that is being operated on.</p>
</li>
<li>
<p><code>setCurrentLayer(Index)</code> - Sets the layer to be operated on.</p>
</li>
<li>
<p><code>removeLayer(Index)</code> - Removes a layer at a given index. The current layer and the last remaining layer in a canvas cannot be removed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All of these functions are exposed through the <code>Model</code> interface.
Implementations in <code>ModelManager</code> usually include a call to the corresponding accessor along with utility functions to manage the state of the UI.</p>
</div>
<div class="paragraph">
<p>Beneath the hood, <code>Canvas</code> manipulation is powered by ImageMagick.
All of the properties represented in <code>Canvas</code> are transformed into their respective flags or arguments in ImageMagick.
For example, the <code>isCanvasAuto</code> property is transformed into the flag <code>-flatten</code> if false and <code>-layers merge</code> if true.</p>
</div>
<div class="paragraph">
<p>The <code>processCanvas</code> is a factory method that handles this transformation, returning an instance of a <code>ProcessBuilder</code>.
The <code>ProcessBuilder</code> is then passed to <code>ImageMagickUtils#runProcessBuilder</code> which executes the process and stores the output in a BufferedImage.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/CanvasSequenceDiagram.png" alt="CanvasSequenceDiagram" width="2000">
</div>
<div class="title">Figure 25. Sequence Diagram for Canvas Command</div>
</div>
<div class="paragraph">
<p>The above diagram illustrates the process of parsing and executing <code>canvas</code> commands.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The user executes any command beginning with <code>canvas</code>.</p>
</li>
<li>
<p>The command is first parsed by <code>PiconsoParser</code> which picks up the <code>canvas</code> keyword and passes any remaining arguments to <code>CanvasCommandParser</code>.</p>
</li>
<li>
<p><code>CanvasCommandParser</code> determines the appropriate sub-command being executed and performs the requested operation on the canvas.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="design-considerations-9"><a class="link" href="#design-considerations-9">4.2.2. Design considerations</a></h4>
<div class="paragraph">
<p><strong>Manipulation of the <code>ProcessBuilder</code></strong></p>
</div>
<div class="paragraph">
<p><span class="underline">Alternatives</span></p>
</div>
<div class="paragraph">
<p>Storing arguments directly in a <code>List&lt;T&gt;</code> where T is a custom type that implements <code>Comparable&lt;T&gt;</code> to ensure that arguments are in the correct order. A helper function will then map the <code>T</code> to a <code>String</code> and the resultant <code>List&lt;String&gt;</code> will be used to construct the necessary <code>ProcessBuilder</code>.</p>
</div>
<div class="paragraph">
<p><span class="underline">Evaluation</span></p>
</div>
<div class="paragraph">
<p>While insertion of new layers and properties will be extremely easy, modifying or removal of existing properties will involve searching through the entire list. As a result, this method is extremely hard to grok and performs poorly upon update or deletion of existing properties.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="layer-layer-commands"><a class="link" href="#layer-layer-commands">4.3. Layer (layer) commands</a></h3>
<div class="paragraph">
<p>The <code>layer</code> command follows a similar pattern as the <code>canvas</code> command.
The following sub-commands inherit from <code>LayerCommand</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>add</code> - Adds a layer from the <code>Canvas</code> and generates a layer name.</p>
</li>
<li>
<p><code>delete</code> - Removes a layer from the <code>Canvas</code>. The current layer and the last remaining layer cannot be removed.</p>
</li>
<li>
<p><code>select</code> - Selects a layer to work on.</p>
</li>
<li>
<p><code>swap</code> - Swaps the order of two distinct layers.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="current-implementation-8"><a class="link" href="#current-implementation-8">4.3.1. Current implementation</a></h4>
<div class="paragraph">
<p><code>Layer</code> implements a few key accessors and utility functions. Some of them include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>addTranformation(Transformation)</code> - Adds a given transformation into its <code>PreviewImage</code>'s <code>TransformationSet</code>.</p>
</li>
<li>
<p><code>getName()</code> - Gets the name of the layer.</p>
</li>
<li>
<p><code>setHeight(int)</code> - Sets the height of the layer.</p>
</li>
<li>
<p><code>setWidth(int)</code> - Sets the width of the layer.</p>
</li>
<li>
<p><code>setPosition(int, int)</code> - Sets the x and y coordinates of the layer.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following image illustrates the coordinate system adopted in Piconso.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/coords.png" alt="coords" width="300">
</div>
</div>
<div class="paragraph">
<p>The default anchor point is the top-left corner, this means that a <code>layer position -10x-10</code> command will set that layer&#8217;s top left corner at <code>(-10, -10)</code>.
It is possible to have negative co-ordinates although clipping will occur unless the canvas is set to auto-resize.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/LayerSequenceDiagram.png" alt="LayerSequenceDiagram" width="2000">
</div>
<div class="title">Figure 26. Sequence Diagram for Layer Command</div>
</div>
<div class="paragraph">
<p>The above diagram illustrates the process of parsing and executing of <code>canvas</code> commands.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The user executes any command beginning with <code>layer</code>.</p>
</li>
<li>
<p>The command is first parsed by <code>PiconsoParser</code> which picks up the <code>layer</code> keyword and passes any remaining arguments to <code>LayerCommandParser</code>.</p>
</li>
<li>
<p><code>LayerCommandParser</code> determines the appropriate sub-command being executed and performs the requested operation on the canvas and current layer.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="design-considerations-10"><a class="link" href="#design-considerations-10">4.3.2. Design Considerations</a></h4>
<div class="paragraph">
<p><strong>Further manipulation of the <code>ProcessBuilder</code></strong></p>
</div>
<div class="paragraph">
<p><em>Alternatives</em></p>
</div>
<div class="paragraph">
<p>It is actually possible to nest <code>ImageMagick</code> commands which means that it is possible to keep separate <code>List&lt;T&gt;</code>s and conjugate them when the canvas needs to be rendered.
The resultant ImageMagick command will take the form :</p>
</div>
<div class="literalblock">
<div class="content">
<pre>magick [overall canvas flags] {[canvas flag] (individual layer flags)} [overall canvas flags]</pre>
</div>
</div>
<div class="paragraph">
<p>Where blocks enclosed by <code>{ }</code> need to be repeated per layer.</p>
</div>
<div class="paragraph">
<p><em>Evaluation</em></p>
</div>
<div class="paragraph">
<p>This solution is the most straight-forward and results in no intermediate files which is usually desirable.</p>
</div>
<div class="paragraph">
<p>However, the resultant ImageMagick command will short circuit and cause the entire expression to fail if any of flags are incompatible or incorrect. Caching is also impossible, causing the whole canvas and all of its layers to be composed again from scratch.
This results in a poor user experience and hence we have decided against it.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="canvas-and-layers-in-action"><a class="link" href="#canvas-and-layers-in-action">4.4. Canvas and Layers in action</a></h3>
<div class="paragraph">
<p>As the <code>canvas</code> and <code>layer</code> commands compliment each other, let&#8217;s walk through a typical user&#8217;s session in Piconso from start to finish.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The user executes a valid <code>open</code> command:
A <code>Canvas</code> is constructed holding exactly one <code>Layer</code>
with the default height and width being that of the image selected.</p>
</li>
<li>
<p>The user adds a new layer to the canvas:
<code>Canvas#addLayer</code> is executed and the helper functions in <code>ModelManager</code> refreshes the UI.</p>
</li>
<li>
<p>The user swaps the order of the two layers to such that the original image is back on top:
<code>Canvas#swapLayer</code> swaps the two entries in the list of layers.</p>
</li>
<li>
<p>While still on the original layer, the user moves it to the top left: <code>Layer#setPosition</code> moves the first layer out of the way.</p>
</li>
<li>
<p>The user decides to work on the second layer and enters <code>layer select 2</code>:
<code>Canvas#setCurrentLayer</code> changes the current layer to the given index and internally keeps track of the index as well.</p>
</li>
<li>
<p>A transformation is applied by the user to the current layer: <code>Canvas#addTransformation</code> appends the new Transformation to the current Layer.
Note that no image processing occurs until a new render is requested.</p>
</li>
<li>
<p>After a <code>canvas size 80x60`command: The new `Canvas#setSize</code> is applied upon the next render and it crops the image to a fraction of what it used to be.
Remember that resizing and scaling is accomplished with the <code>apply resize</code> command.</p>
</li>
<li>
<p>Realising his mistake, the user sets the canvas to fit his all of his layers: <code>Canvas#setCanvasAuto</code> toggles a boolean.</p>
</li>
<li>
<p>The user fills in the default transparent background with a <code>canvas bgcolor #707070</code> : a hex color code is accepted by <code>Canvas#setBackgroundColor</code>.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/CanvasLayersDemo.png" alt="CanvasLayersDemo" width="2000">
</div>
<div class="title">Figure 27. Results of various commands in sequence. The black bounding rectangle indicates the canvas size.</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="implementation-google-features"><a class="link" href="#implementation-google-features">5. Implementation: Google features</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="overall-introduction"><a class="link" href="#overall-introduction">5.1. Overall Introduction</a></h3>
<div class="paragraph">
<p>The Google commands allow for access to <a href="https://developers.google.com/photos/library/guides/get-started-java">Google Photos</a> through a logged-in instance of the user, and are held up by two main components.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>PhotosLibraryClientFactory</code> - Initiates and carries out the login process. Produces a <code>PhotoHandler</code> instance, which handles matters related to Google commands.</p>
</li>
<li>
<p><code>PhotoHandler</code> - Mainly consists of a <code>PhotoLibraryClient</code> instance, the user&#8217;s logged in state, and 3 maps for storing images, albums, and specific images from an album. Performs all explicit calls to Google Photos through the <code>PhotosLibraryClient</code> instance and parses results.</p>
<div class="ulist">
<ul>
<li>
<p>The <code>PhotoHandler</code> instance is later accessed through <code>Model#getPhotoHandler()</code> and <code>Model#setPhotoHandler()`</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>There are 6 main google-related commands. The first two commands login/logout a user, and the latter 4 are mostly overloaded command types with <code>GoogleCommand</code> as the abstract parent class.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>LoginCommand</code> - Logs in user to their Google Account.</p>
</li>
<li>
<p><code>LogoutCommand</code> - Logs a user out of their Google Account.</p>
</li>
<li>
<p><code>GoogleLsCommand</code> - Lists files in Google Photos.</p>
</li>
<li>
<p><code>GoogleRefreshCommand</code> - Refreshes the displayed list from Google Photos.</p>
</li>
<li>
<p><code>GoogleDlCommand</code> - Downloads the specified image(s) from Google Photos to the user&#8217;s currently opened local directory.</p>
</li>
<li>
<p><code>GoogleUploadCommand</code> - Uploads the specified image(s) from the user&#8217;s currently opened local directory to Google Photos.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We have connected and generated <code>client_credentials.json</code> via our own Google Account to enable usage of Google Photos API in Piconso. It is recommended that you <a href="https://developers.google.com/photos/library/guides/get-started-java">configure</a> Piconso to use Google Photos Library API with your own account rather than the provided.<br></p>
</div>
<div class="paragraph">
<p>If you are not familiar with how Google Photos works, it would be advisable to first try out Google Photos as a consumer before proceeding.</p>
</div>
</div>
<div class="sect2">
<h3 id="login-login-command"><a class="link" href="#login-login-command">5.2. Login (login) Command</a></h3>
<div class="sect3">
<h4 id="current-implementation-9"><a class="link" href="#current-implementation-9">5.2.1. Current Implementation</a></h4>
<div class="paragraph">
<p>The Login command currently authenticates a user via Google OAuth. To learn more about the implementation of OAuth methods, you may refer to <a href="https://developers.google.com/identity/protocols/OAuth2#installed">O-Auth Explanation</a> and <a href="https://developers.google.com/api-client-library/java/google-api-java-client/oauth2#installed_applications">Google API examples</a>. As the workings of Google OAuth are rather complicated, it is suggested that you first go through the examples/documentations in those links.<br></p>
</div>
<div class="paragraph">
<p>The following static methods of <code>PhotosLibraryClientFactory</code> will be involved:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>createClient()</code> - Creates a PhotoLibrary instance, contains calls to Google OAuth related methods.</p>
</li>
<li>
<p><code>createPhotosLibraryClient(Credentials)</code> - Creates an instance of Google&#8217;s PhotosLibraryClient using the provided credentials.</p>
</li>
<li>
<p><code>getUserEmail(Credential)</code> - Retrieves the user&#8217;s email from Google+.</p>
</li>
<li>
<p><code>loginUserIfPossible()</code> - Logs in a user if a valid credential file can be found during start up.</p>
</li>
<li>
<p><code>logoutUserIfPossible()</code> - Logs a user out if a credential file can be found.</p>
</li>
<li>
<p><code>checkUserLogin()</code> - Checks if any users are currently logged in.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Below are some examples on how the login command will work.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If connection to the internet is lost at any point during authentication with Google&#8217;s server, login will fail and an error message will be sent to user as feedback.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="scenario-1-explicit-code-login-code-command-executed-user-not-logged-in-yet"><a class="link" href="#scenario-1-explicit-code-login-code-command-executed-user-not-logged-in-yet">5.2.2. Scenario 1: Explicit <code>login</code> command executed, user not logged in yet.</a></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The user executes a <code>login</code> command.</p>
</li>
<li>
<p>The login command calls <code>Model#getPhotoHandler()</code> and checks if a PhotoHandler instance already exists. If not, it calls static method <code>PhotoLibraryClientFactory#createClient()</code> to set up the requirements for log in and redirects the user to the browser.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This occurs asynchronously, and a user can close the redirect window and proceed as usual with the application if they have changed their mind.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>User logs in through redirect window and a refresh token is returned and stored. PhotoLibraryClientFactory class then calls <code>PhotoLibraryClientFactory#createPhotosLibraryClient()</code> and <code>PhotoLibraryClientFactory#getUserEmail()</code> to instantiate a <code>PhotoHandler</code> instance</p>
</li>
<li>
<p>The <code>PhotoHandler</code> instance is set by model as <code>Model#photoLibrary</code>, and confirmation of login is sent to user.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The following sequence diagram illustrates how the above steps work:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/LoginSequenceDiagram.png" alt="LoginSequenceDiagram" width="1000">
</div>
<div class="title">Figure 28. Sequence Diagram for LoginCommand</div>
</div>
</div>
<div class="sect3">
<h4 id="scenario-2-implicit-login-where-piconso-auto-logs-in-user-upon-re-launch"><a class="link" href="#scenario-2-implicit-login-where-piconso-auto-logs-in-user-upon-re-launch">5.2.3. Scenario 2: Implicit login, where Piconso auto logs in user upon re-launch</a></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Upon Piconso start up, <code>PhotoLibraryClientFactory#loginUserIfPossible()</code> is run by <code>ModelManager</code><br></p>
</li>
<li>
<p>The method checks for stored credentials (refresh token), and logs in user via <code>PhotoLibraryClientFactory#createClient()</code> if possible, else the log in process is skipped.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In both scenarios, whenever a valid refresh token is found stored the user is logged in without having to face browser re-direct again. At no point in time will we be storing a user&#8217;s actual credentials, but only a refresh token that allows us to keep a user logged in, actual credentials are handled by Google OAuth<br></p>
</div>
</div>
<div class="sect3">
<h4 id="design-considerations-11"><a class="link" href="#design-considerations-11">5.2.4. Design Considerations</a></h4>
<div class="paragraph">
<p><strong>Asynchronous Login</strong>: By default, as long as a user has not logged in after <code>login</code> command is launched, Piconso freezes and waits for user input.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Current Solution</em>: An asynchronous approach has been implemented instead such that Piconso continues working as usual even if the user has not logged in. Once a user is logged in, Piconso will simply show feedback.</p>
</li>
<li>
<p><em>Cons</em>: Google allows max 3 login requests to be made in an interval, hence the <code>login</code> command will stop redirecting after 3 consecutive logins made in a short period of time. While it is unlikely this will pose a problem for users, it would be advisable to display the redirect URL in the Piconso CLI during future development.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="logout-logout-command"><a class="link" href="#logout-logout-command">5.2.5. Logout (logout) Command</a></h4>
<div class="paragraph">
<p>The logout command deletes the stored credential file (and any other login-related files) if it exists, and does nothing if it does not. Upon deleting the file, the user will no longer have a refresh token to stay logged in, and thus is effectively logged out.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="googlelscommand-ls"><a class="link" href="#googlelscommand-ls">5.3. GoogleLsCommand (ls)</a></h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For all Google-related Commands (excluding login and logout), their command word is appended with a g (i.e <code>g ls</code>). Thus all children of <code>GoogleCommand</code> are first passed through a <code>GoogleCommandParser</code> to determine its type.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="current-implementation-10"><a class="link" href="#current-implementation-10">5.3.1. Current Implementation</a></h4>
<div class="paragraph">
<p>The <code>GoogleLsCommand</code> allows users to browse through their stored images on Google Photos. Currently, it is overloaded with three types of commands the user can type</p>
</div>
<div class="paragraph">
<p><code>g ls</code> &#8594; Lists all photos in user&#8217;s Google Photos, takes a longer amount of time depending on the number of images stored.<br>
<code>g ls /a</code> &#8594; Lists all albums in user&#8217;s Google Photos.<br>
<code>g ls &lt;ALBUM_NAME&gt;</code> &#8594; Lists all photos in specified album from Google Photos.</p>
</div>
<div class="paragraph">
<p>As such, parsing will be done twice. Once by <code>GoogleCommandParser</code>, and another within <code>GoogleLsCommand</code> itself.</p>
</div>
<div class="paragraph">
<p>The following methods and components of <code>PhotoHandler</code> will be involved:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>imageMap</code> - Map&lt;String, MediaItem&gt; that contains the list of images retrieved from Google API call. Uses image names as keys.</p>
</li>
<li>
<p><code>albumMap</code> - Map&lt;String, Album&gt; that contains the list of albums retrieved from Google API call. Uses album names as keys.</p>
</li>
<li>
<p><code>specificAlbumMap</code> - Map&lt;String, MediaItem&gt; that contains the list of images from a specific album retrieved from Google API call. Uses image names as keys.</p>
</li>
<li>
<p><code>getUniqueName(Map, String, String)</code> - Checks for existence of a name in the map. If it exists, append a sutiable index at the end of the name.</p>
</li>
<li>
<p><code>refreshLists()</code> - Re-retrieves all images and albums from Google Photos and updates <code>imageMap</code> and <code>albumMap</code></p>
</li>
<li>
<p><code>returnAllAlbumsList()</code> - Calls <code>retrieveAllAlbumsFromGoogle()</code> and returns a <code>List</code> of Album names for easy display</p>
</li>
<li>
<p><code>retrieveAllAlbumsFromGoogle()</code> - Makes a Google API call and retrieves all albums stored in Google Photos, storing it in <code>albumMap</code>.</p>
<div class="ulist">
<ul>
<li>
<p>Similar methods for other variants exist, but only methods used for the example below will be listed.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="example-first-call-for-code-g-ls-a-code-where-user-wants-to-list-all-albums-in-google-photos"><a class="link" href="#example-first-call-for-code-g-ls-a-code-where-user-wants-to-list-all-albums-in-google-photos">5.3.2. Example: First call for <code>g ls /a</code>, where user wants to list all albums in Google Photos.</a></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The user executes a <code>g ls /a</code> command.</p>
</li>
<li>
<p>The command goes through parsing, firstly by <code>GoogleCommandParser</code> and secondly filtered by GoogleLsCommand. It is determined to be for listing albums, and <code>model.getPhotoHandler().returnAllAlbumsList()</code> is called.</p>
</li>
<li>
<p>Within that method, it makes a request to Google Photos, retrieves a <code>List&lt;Album&gt;</code>, and stores them in a <code>Map&lt;String, Album&gt;</code> within the PhotoHandler instance, with each key being the album name, any duplicate names are renamed.</p>
</li>
<li>
<p>The entire list is converted into a String, and returned to the <code>CommandBox</code> UI as feedback to the user</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The following activity diagram illustrates how the above steps work:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/GoogleLsActivityDiagram.png" alt="GoogleLsActivityDiagram" width="1000">
</div>
<div class="title">Figure 29. Activity Diagram for GoogleLsCommand</div>
</div>
<div class="paragraph">
<p>The process is similar for the other 2 variants, except images or images from a specific album are retrieved instead. All retrieved results are always stored in their respective maps.</p>
</div>
</div>
<div class="sect3">
<h4 id="design-considerations-12"><a class="link" href="#design-considerations-12">5.3.3. Design Considerations</a></h4>
<div class="paragraph">
<p><strong>Performance Issues</strong>: The larger the amount of pictures stored in Google Photos, the longer amount of time a <code>g ls</code> command takes.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Alternative 1</em>: Re-retrieve the list of photos/albums upon every <code>ls</code> call</p>
<div class="ulist">
<ul>
<li>
<p>Pro: Displayed list of images/albums is always up-to-date.</p>
</li>
<li>
<p>Con: Each Google Photos API call takes a notable amount of time to execute. Constantly re-retrieving the list of images/albums causes multiples API calls and incurs heavy waiting time for users.</p>
</li>
</ul>
</div>
</li>
<li>
<p><em>Alternative 2 (Current)</em>: Adding a refresh command. As it is not likely that the set of photos in Google Photos will constantly change, the list of images/albums is retrieved and stored upon first <code>g ls</code> call and is only refreshed upon <code>g refresh</code>.</p>
<div class="ulist">
<ul>
<li>
<p>Pro: Shortens the waiting time for user on every <code>g ls</code> call</p>
</li>
<li>
<p>Con: More work on user&#8217;s behalf to remember to refresh.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Duplicated Naming</strong>: Google Photos allows for multiples images and albums to be stored with the same name, making it difficult to list item names as names might overlap.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Alternative 1 (Current)</em>: Upon a retrieval of images/albums from Google, image/album names are checked for duplicates. Every duplicate will have a suitable index appended at the end of its original name to ensures that unique naming occurs.</p>
<div class="ulist">
<ul>
<li>
<p>Con: If there are multiple images with the same name, the process of any <code>g ls</code> or <code>g refresh</code> will take a longer time to run.</p>
</li>
</ul>
</div>
</li>
<li>
<p><em>Alternative 2</em>: Instead of storing the name of the image/album as the key inside the Map, its unique ID (that is retrieved together with the files from Google) can be used instead.</p>
<div class="ulist">
<ul>
<li>
<p>Con: The ID too complicated for a user to input and remember.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Album Traversal: How to display and use Albums from Google</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Alternative 1</em>: Treat the album as a category, thus <code>g ls &lt;ALBUM_NAME&gt;</code> acts as a filter that filters photos by category.</p>
<div class="ulist">
<ul>
<li>
<p>Pro: Easy for users to understand and remember.</p>
</li>
<li>
<p>Con: The command to download from an album needs to be extended such that users need to specify which album the image to download is in i.e <code>g dl /a&lt;Album&gt; /i&lt;image.png&gt;</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><em>Alternative 2</em>: Handle the concept of albums like directories, such that a user can cd in and out of an album.</p>
<div class="ulist">
<ul>
<li>
<p>Con: Confusing for users to concurrently navigate and differentiate both google and local directories.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="googlerefreshcommand-refresh"><a class="link" href="#googlerefreshcommand-refresh">5.3.4. GoogleRefreshCommand (refresh)</a></h4>
<div class="paragraph">
<p>The refresh command re-retrieves and stores the list of images/albums from Google Photos into respective maps in <code>Model#getPhotoHandler()</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="googledlcommand-dl"><a class="link" href="#googledlcommand-dl">5.4. GoogleDlCommand (dl)</a></h3>
<div class="sect3">
<h4 id="current-implementation-11"><a class="link" href="#current-implementation-11">5.4.1. Current Implementation</a></h4>
<div class="paragraph">
<p>The GoogleDlCommand allows users to download their stored images on Google Photos. Currently, it is overloaded with three types of commands the user can type</p>
</div>
<div class="paragraph">
<p><code>g dl /i&lt;IMAGE_NAME&gt;</code>: Downloads specified image from Google Photos<br>
<code>g dl /a&lt;ALBUM_NAME&gt;</code>: Downloads all images from specified album in Google Photos, takes a longer amount of time depending on the number of images stored in the album.<br>
<code>g dl /a&lt;ALBUM_NAME&gt; /i&lt;IMAGE_NAME&gt;</code>: Downloads a specific photo from a specific album in Google Photos.</p>
</div>
<div class="paragraph">
<p>As such, parsing will be done twice. Once by GoogleCommandParser, and another within GoogleDlCommand itself.</p>
</div>
<div class="paragraph">
<p>The following components of <code>PhotoHandler</code> will be involved:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>downloadImage(String, String, String)</code> - Ensures the request is valid and calls saveImageInDir()` if true.</p>
</li>
<li>
<p><code>saveImageInDir(MediaItem, String)</code> - Saves the image using the baseURL of the <code>MediaItem</code></p>
<div class="ulist">
<ul>
<li>
<p>Similar methods for other variants exist, but only methods used for the example below will be listed.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="example-g-dl-i-b-png"><a class="link" href="#example-g-dl-i-b-png">5.4.2. Example: g dl /i&lt;b.png&gt;`</a></h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For all upload/download related commands, the amount of time taken to process the task varies with the number of images to upload/download.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The user executes a <code>g dl /i&lt;b.png&gt;</code> command.</p>
</li>
<li>
<p>The command goes through parsing, firstly by <code>GoogleCommandParser</code> and secondly filtered by GoogleDlCommand. It is determined to be for downloading one image, and <code>model.getPhotoHandler().downloadImage()</code> is called.</p>
</li>
<li>
<p>Within that method, it makes a request to Google Photos with the image&#8217;s respective ID, and successfully downloads the image into the user&#8217;s local directory.</p>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
If the local directory contains any image with the same name as the one to download, the image in the local directory will be replaced.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Feedback of success is sent to the user</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/GoogleDlSequenceDiagram.png" alt="GoogleDlSequenceDiagram" width="800">
</div>
<div class="title">Figure 30. Sequence Diagram for GoogleDlCommand</div>
</div>
<div class="paragraph">
<p>The process is similar for the other 2 variants, except images or images from a specific album are downloaded instead.</p>
</div>
</div>
<div class="sect3">
<h4 id="design-considerations-13"><a class="link" href="#design-considerations-13">5.4.3. Design Considerations</a></h4>
<div class="paragraph">
<p><strong>Location of downloaded images</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Alternative 1 (Current)</em>: Download the image into user&#8217;s currently opened local directory.</p>
<div class="ulist">
<ul>
<li>
<p>Pro: User is able to easily find the new downloaded photo</p>
</li>
<li>
<p>Con: Images with the same name WILL be replaced and it will be messy when multiple photos are downloaded</p>
</li>
</ul>
</div>
</li>
<li>
<p><em>Alternative 2 (Recommended for future)</em>: Images are downloaded into a specific directory which can be navigated to and fro via quick commands (i.e <code>jump to PicDir</code>, <code>jump back PicDir</code>)</p>
<div class="ulist">
<ul>
<li>
<p>Pro: Easier for user to retrieve and view downloaded photos. Photos with the same name can also be safely replaced as they are likely earlier versions downloaded from Google Photos.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="googleuploadcommand-ul"><a class="link" href="#googleuploadcommand-ul">5.5. GoogleUploadCommand (ul)</a></h3>
<div class="sect3">
<h4 id="current-implementation-12"><a class="link" href="#current-implementation-12">5.5.1. Current Implementation</a></h4>
<div class="paragraph">
<p>The GoogleUploadCommand allows users to upload their images onto Google Photos. Currently, it is overloaded with two types of commands the user can type</p>
</div>
<div class="paragraph">
<p><code>g ul &lt;IMAGE_NAME&gt;</code>: Uploads specified image from currently opened directory to Google Photos<br>
<code>g ul all</code>: Uploads all images in currently open local directory.</p>
</div>
<div class="paragraph">
<p>As such, parsing will be done twice. Once by GoogleCommandParser, and another within GoogleUploadCommand itself.</p>
</div>
<div class="paragraph">
<p>As the implementation of GoogleUploadCommand is mostly dependent on understanding of the upload aspects of Google Photos API, an example will not be given. Please refer to <a href="https://developers.google.com/photos/library/guides/upload-media">this link</a>.</p>
</div>
<div class="paragraph">
<p>The following components of <code>PhotoHandler</code> will be involved:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>uploadImage(String, String)</code> - Uploads the image from the current opened local directory.</p>
</li>
<li>
<p><code>retrievePiconsoAlbum()</code> - Retrieves the ID of the Piconso Album in Google Photos. If it does not exist, command creates one.</p>
</li>
<li>
<p><code>uploadMediaItemsToGoogle(List&lt;NewMediaItem&gt;)</code> - Highly Google Photos API based, returns a <code>NewMediaItem</code></p>
</li>
<li>
<p><code>generateNewMediaImage(String, String)</code> - Highly Google Photos API based, carries out actual upload to Google Photos with NewMediaItem.</p>
<div class="ulist">
<ul>
<li>
<p>Similar methods for other variants exist, but only methods used for the example below will be listed.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="design-considerations-14"><a class="link" href="#design-considerations-14">5.5.2. Design Considerations</a></h4>
<div class="paragraph">
<p><strong>Google Photos does not allow duplicate photos</strong>: Illustrated in the diagram below</p>
</div>
<div class="ulist">
<ul>
<li>
<p>No renaming of photos after upload allowed.</p>
</li>
<li>
<p>If an image is uploaded as "a.png", but exists with the exact same bytes as "b.png" on Google Photos, the image will replace the old image as b.png instead.</p>
</li>
<li>
<p>If two images with the same bytes are sent for upload, only the first will be uploaded.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/uploadExplanation.png" alt="uploadExplanation" width="800">
</div>
<div class="title">Figure 31. Illustrates when how Google Photos handles images</div>
</div>
<div class="paragraph">
<p>Currently the only measure taken has been to state this to the user. As this issue was only discovered in the later stages of development, it does not have a workaround yet. Though a lot of refactoring will be required,  switching from Google Photos to Google Drive might be a fix for the problem.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="documentation"><a class="link" href="#documentation">6. Documentation</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>We use asciidoc for writing documentation.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
We chose asciidoc over Markdown because asciidoc, although a bit more complex than Markdown, provides more flexibility in formatting.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="editing-documentation"><a class="link" href="#editing-documentation">6.1. Editing Documentation</a></h3>
<div class="paragraph">
<p>See <a href="UsingGradle.html#rendering-asciidoc-files">UsingGradle.adoc</a> to learn how to render <code>.adoc</code> files locally to preview the end result of your edits.
Alternatively, you can download the AsciiDoc plugin for IntelliJ, which allows you to preview the changes you have made to your <code>.adoc</code> files in real-time.</p>
</div>
</div>
<div class="sect2">
<h3 id="publishing-documentation"><a class="link" href="#publishing-documentation">6.2. Publishing Documentation</a></h3>
<div class="paragraph">
<p>See <a href="UsingTravis.html#deploying-github-pages">UsingTravis.adoc</a> to learn how to deploy GitHub Pages using Travis.</p>
</div>
</div>
<div class="sect2">
<h3 id="converting-documentation-to-pdf-format"><a class="link" href="#converting-documentation-to-pdf-format">6.3. Converting Documentation to PDF format</a></h3>
<div class="paragraph">
<p>We use <a href="https://www.google.com/chrome/browser/desktop/">Google Chrome</a> for converting documentation to PDF format, as Chrome&#8217;s PDF engine preserves hyperlinks used in webpages.</p>
</div>
<div class="paragraph">
<p>Here are the steps to convert the project documentation files to PDF format.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Follow the instructions in <a href="UsingGradle.html#rendering-asciidoc-files">UsingGradle.adoc</a> to convert the AsciiDoc files in the <code>docs/</code> directory to HTML format.</p>
</li>
<li>
<p>Go to your generated HTML files in the <code>build/docs</code> folder, right click on them and select <code>Open with</code> &#8594; <code>Google Chrome</code>.</p>
</li>
<li>
<p>Within Chrome, click on the <code>Print</code> option in Chrome&#8217;s menu.</p>
</li>
<li>
<p>Set the destination to <code>Save as PDF</code>, then click <code>Save</code> to save a copy of the file in PDF format. For best results, use the settings indicated in the screenshot below.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/chrome_save_as_pdf.png" alt="chrome save as pdf" width="300">
</div>
<div class="title">Figure 32. Saving documentation as PDF files in Chrome</div>
</div>
</div>
<div class="sect2">
<h3 id="Docs-SiteWideDocSettings"><a class="link" href="#Docs-SiteWideDocSettings">6.4. Site-wide Documentation Settings</a></h3>
<div class="paragraph">
<p>The <a href="https://github.com/CS2103-AY1819S1-T09-3/main/build.gradle"><code>build.gradle</code></a> file specifies some project-specific <a href="https://asciidoctor.org/docs/user-manual/#attributes">asciidoc attributes</a> which affects how all documentation files within this project are rendered.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Attributes left unset in the <code>build.gradle</code> file will use their <strong>default value</strong>, if any.
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 1. List of site-wide attributes</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 50%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>site-name</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The name of the website.
If set, the name will be displayed near the top of the page.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>not set</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>site-githuburl</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>URL to the site&#8217;s repository on <a href="https://github.com">GitHub</a>.
Setting this will add a "View on GitHub" link in the navigation bar.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>not set</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>site-seedu</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Define this attribute if the project is an official SE-EDU project.
This will render the SE-EDU navigation bar at the top of the page, and add some SE-EDU-specific navigation items.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>not set</em></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="Docs-PerFileDocSettings"><a class="link" href="#Docs-PerFileDocSettings">6.5. Per-file Documentation Settings</a></h3>
<div class="paragraph">
<p>Each <code>.adoc</code> file may also specify some file-specific <a href="https://asciidoctor.org/docs/user-manual/#attributes">asciidoc attributes</a> which affects how the file is rendered.</p>
</div>
<div class="paragraph">
<p>Asciidoctor&#8217;s <a href="https://asciidoctor.org/docs/user-manual/#builtin-attributes">built-in attributes</a> may be specified and used as well.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Attributes left unset in <code>.adoc</code> files will use their <strong>default value</strong>, if any.
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 2. List of per-file attributes, excluding Asciidoctor&#8217;s built-in attributes</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 50%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>site-section</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Site section that the document belongs to.
This will cause the associated item in the navigation bar to be highlighted.
One of: <code>UserGuide</code>, <code>DeveloperGuide</code>, <code>LearningOutcomes</code>*, <code>AboutUs</code>, <code>ContactUs</code></p>
</div>
<div class="paragraph">
<p><em>* Official SE-EDU projects only</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>not set</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>no-site-header</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Set this attribute to remove the site navigation bar.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>not set</em></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="site-template"><a class="link" href="#site-template">6.6. Site Template</a></h3>
<div class="paragraph">
<p>The files in <a href="https://github.com/CS2103-AY1819S1-T09-3/main/docs/stylesheets"><code>docs/stylesheets</code></a> are the <a href="https://developer.mozilla.org/en-US/docs/Web/CSS">CSS stylesheets</a> of the site.
You can modify them to change some properties of the site&#8217;s design.</p>
</div>
<div class="paragraph">
<p>The files in <a href="https://github.com/CS2103-AY1819S1-T09-3/main/docs/templates"><code>docs/templates</code></a> controls the rendering of <code>.adoc</code> files into HTML5.
These template files are written in a mixture of <a href="https://www.ruby-lang.org">Ruby</a> and <a href="http://slim-lang.com">Slim</a>.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Modifying the template files in <a href="https://github.com/CS2103-AY1819S1-T09-3/main/docs/templates"><code>docs/templates</code></a> requires some knowledge and experience with Ruby and Asciidoctor&#8217;s API.
You should only modify them if you need greater control over the site&#8217;s layout than what stylesheets can provide.
The SE-EDU team does not provide support for modified template files.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Testing"><a class="link" href="#Testing">7. Testing</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="running-tests"><a class="link" href="#running-tests">7.1. Running Tests</a></h3>
<div class="paragraph">
<p>There are three ways to run tests.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The most reliable way to run tests is the 3rd one. The first two methods might fail some GUI tests due to platform/resolution-specific idiosyncrasies.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Method 1: Using IntelliJ JUnit test runner</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>To run all tests, right-click on the <code>src/test/java</code> folder and choose <code>Run 'All Tests'</code></p>
</li>
<li>
<p>To run a subset of tests, you can right-click on a test package, test class, or a test and choose <code>Run 'ABC'</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Method 2: Using Gradle</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Open a console and run the command <code>gradlew clean allTests</code> (Mac/Linux: <code>./gradlew clean allTests</code>)</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
See <a href="UsingGradle.html">UsingGradle.adoc</a> for more info on how to run tests using Gradle.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Method 3: Using Gradle (headless)</strong></p>
</div>
<div class="paragraph">
<p>Thanks to the <a href="https://github.com/TestFX/TestFX">TestFX</a> library we use, our GUI tests can be run in the <em>headless</em> mode. In the headless mode, GUI tests do not show up on the screen. That means the developer can do other things on the Computer while the tests are running.</p>
</div>
<div class="paragraph">
<p>To run tests in headless mode, open a console and run the command <code>gradlew clean headless allTests</code> (Mac/Linux: <code>./gradlew clean headless allTests</code>)</p>
</div>
</div>
<div class="sect2">
<h3 id="types-of-tests"><a class="link" href="#types-of-tests">7.2. Types of tests</a></h3>
<div class="paragraph">
<p>We have two types of tests:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>GUI Tests</strong> - These are tests involving the GUI. They include,</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><em>System Tests</em> that test the entire App by simulating user actions on the GUI. These are in the <code>systemtests</code> package.</p>
</li>
<li>
<p><em>Unit tests</em> that test the individual components. These are in <code>seedu.address.ui</code> package.</p>
</li>
</ol>
</div>
</li>
<li>
<p><strong>Non-GUI Tests</strong> - These are tests not involving the GUI. They include,</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><em>Unit tests</em> targeting the lowest level methods/classes.<br>
e.g. <code>seedu.address.commons.StringUtilTest</code></p>
</li>
<li>
<p><em>Integration tests</em> that are checking the integration of multiple code units (those code units are assumed to be working).<br>
e.g. <code>seedu.address.storage.StorageManagerTest</code></p>
</li>
<li>
<p>Hybrids of unit and integration tests. These test are checking multiple code units as well as how the are connected together.<br>
e.g. <code>seedu.address.logic.LogicManagerTest</code></p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="troubleshooting-testing"><a class="link" href="#troubleshooting-testing">7.3. Troubleshooting Testing</a></h3>
<div class="paragraph">
<p><strong>Problem: <code>HelpWindowTest</code> fails with a <code>NullPointerException</code>.</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Reason: One of its dependencies, <code>HelpWindow.html</code> in <code>src/main/resources/docs</code> is missing.</p>
</li>
<li>
<p>Solution: Execute Gradle task <code>processResources</code>.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dev-ops"><a class="link" href="#dev-ops">8. Dev Ops</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="build-automation"><a class="link" href="#build-automation">8.1. Build Automation</a></h3>
<div class="paragraph">
<p>See <a href="UsingGradle.html">UsingGradle.adoc</a> to learn how to use Gradle for build automation.</p>
</div>
</div>
<div class="sect2">
<h3 id="continuous-integration"><a class="link" href="#continuous-integration">8.2. Continuous Integration</a></h3>
<div class="paragraph">
<p>We use <a href="https://travis-ci.org/">Travis CI</a> and <a href="https://www.appveyor.com/">AppVeyor</a> to perform <em>Continuous Integration</em> on our projects. See <a href="UsingTravis.html">UsingTravis.adoc</a> and <a href="UsingAppVeyor.html">UsingAppVeyor.adoc</a> for more details.</p>
</div>
</div>
<div class="sect2">
<h3 id="coverage-reporting"><a class="link" href="#coverage-reporting">8.3. Coverage Reporting</a></h3>
<div class="paragraph">
<p>We use <a href="https://coveralls.io/">Coveralls</a> to track the code coverage of our projects. See <a href="UsingCoveralls.html">UsingCoveralls.adoc</a> for more details.</p>
</div>
</div>
<div class="sect2">
<h3 id="documentation-previews"><a class="link" href="#documentation-previews">8.4. Documentation Previews</a></h3>
<div class="paragraph">
<p>When a pull request has changes to asciidoc files, you can use <a href="https://www.netlify.com/">Netlify</a> to see a preview of how the HTML version of those asciidoc files will look like when the pull request is merged. See <a href="UsingNetlify.html">UsingNetlify.adoc</a> for more details.</p>
</div>
</div>
<div class="sect2">
<h3 id="making-a-release"><a class="link" href="#making-a-release">8.5. Making a Release</a></h3>
<div class="paragraph">
<p>Here are the steps to create a new release.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Update the version number in <a href="https://github.com/CS2103-AY1819S1-T09-3/main/src/main/java/seedu/address/MainApp.java"><code>MainApp.java</code></a>.</p>
</li>
<li>
<p>Generate a JAR file <a href="UsingGradle.html#creating-the-jar-file">using Gradle</a>.</p>
</li>
<li>
<p>Tag the repo with the version number. e.g. <code>v0.1</code></p>
</li>
<li>
<p><a href="https://help.github.com/articles/creating-releases/">Create a new release using GitHub</a> and upload the JAR file you created.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="managing-dependencies"><a class="link" href="#managing-dependencies">8.6. Managing Dependencies</a></h3>
<div class="paragraph">
<p>A project often depends on third-party libraries. For example, Address Book depends on the <a href="http://wiki.fasterxml.com/JacksonHome">Jackson library</a> for XML parsing. Managing these <em>dependencies</em> can be automated using Gradle. For example, Gradle can download the dependencies automatically, which is better than these alternatives.<br>
a. Include those libraries in the repo (this bloats the repo size)<br>
b. Require developers to download those libraries manually (this creates extra work for developers)</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="product-scope"><a class="link" href="#product-scope">Appendix A: Product Scope</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Target user profile</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>needs a quick and easy way to edit images</p>
</li>
<li>
<p>has a lot of images to edit</p>
</li>
<li>
<p>appreciates the power that traditional editing software provides</p>
</li>
<li>
<p>familiar with the command line</p>
</li>
<li>
<p>prefers typing over mouse input</p>
</li>
<li>
<p>is reasonably comfortable using CLI app</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Value proposition</strong>: view, preview and edit images quickly in a streamlined, modular and repeatable process</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="user-stories"><a class="link" href="#user-stories">Appendix B: User Stories</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Priorities: High (must have) - <code>* * *</code>, Medium (nice to have) - <code>* *</code>, Low (unlikely to have) - <code>*</code></p>
</div>
<table class="tableblock frame-all grid-all" style="width: 59%;">
<colgroup>
<col style="width: 22%;">
<col style="width: 23%;">
<col style="width: 25%;">
<col style="width: 30%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Priority</th>
<th class="tableblock halign-left valign-top">As a &#8230;&#8203;</th>
<th class="tableblock halign-left valign-top">I want to &#8230;&#8203;</th>
<th class="tableblock halign-left valign-top">So that I can&#8230;&#8203;</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>* * *</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">photographer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">edit an image</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">enhance an image</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>* * *</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">photographer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">define my own set of transformations</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">avoid repetitive typing of commands</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>* * *</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">photographer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">see the preview of the transformations before committing to disk</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">explore the effects of transformations</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>* *</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">photographer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">be able to upload my photos to the cloud (Google Photos)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">safely store and share my photos across devices</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">web developer or photographer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">add captions or watermarks to images</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">to protect my intellectual property</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">web developer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">quickly recolor icons</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">easily use them in re-skinning my application</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="use-cases"><a class="link" href="#use-cases">Appendix C: Use Cases</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>(For all use cases below, the <strong>System</strong> is <code>Piconso</code> and the <strong>Actor</strong> is the <code>user</code>, unless specified otherwise)</p>
</div>
<h3 id="use-case-editing-an-image" class="discrete">Use case: Editing an image</h3>
<div class="paragraph">
<p><strong>MSS</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>User opens an image</p>
</li>
<li>
<p>User uses the CLI to describe a set of transformations to the image</p>
</li>
<li>
<p>Piconso shows a preview of the outcome</p>
</li>
<li>
<p>User can save the outcome/transformation to disk</p>
<div class="paragraph">
<p>Use case ends.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Extensions</strong></p>
</div>
<div class="ulist none">
<ul class="none">
<li>
<p>1a. The given image cannot be opened.</p>
<div class="ulist none">
<ul class="none">
<li>
<p>1a1. Piconso shows an error message.</p>
<div class="paragraph">
<p>Use case resumes at step 1.</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>2a. User is unsatisfied with the last transformation.</p>
<div class="ulist none">
<ul class="none">
<li>
<p>2a1. User can undo the last transformation.</p>
<div class="paragraph">
<p>Use case resumes at step 2.</p>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<h3 id="use-case-define-a-set-of-transformations" class="discrete">Use case: Define a set of transformations</h3>
<div class="paragraph">
<p><strong>MSS</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>User edits an image (from use case Editing an image)</p>
</li>
<li>
<p>Piconso displays transformations done on the left side pane</p>
</li>
<li>
<p>User enters command to save the set of transformations</p>
</li>
<li>
<p>Piconso requests for a name for the set</p>
</li>
<li>
<p>User enters a name</p>
</li>
<li>
<p>Piconso saves the set</p>
<div class="paragraph">
<p>Use case ends.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Extensions</strong></p>
</div>
<div class="ulist none">
<ul class="none">
<li>
<p>5a. The input name is already used.</p>
<div class="ulist none">
<ul class="none">
<li>
<p>5a1. Piconso asks if user wants to overwrite to previously stored set.</p>
<div class="paragraph">
<p>Use case resumes at step 4.</p>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<h3 id="use-case-add-caption-or-watermark-to-image" class="discrete">Use case: Add caption or watermark to image</h3>
<div class="paragraph">
<p><strong>MSS</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>User opens an image</p>
</li>
<li>
<p>Piconso displays the image in the preview pane</p>
</li>
<li>
<p>User adds caption or watermark image through input</p>
</li>
<li>
<p>Piconso displays the caption/watermark in the preview pane atop the first layer.</p>
<div class="paragraph">
<p>Use case ends.</p>
</div>
</li>
</ol>
</div>
<h3 id="use-case-upload-to-google-photos" class="discrete">Use case: Upload to Google Photos</h3>
<div class="paragraph">
<p><strong>MSS</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>User request to login to Google Photos</p>
</li>
<li>
<p>Piconso redirects the user to a login browser page</p>
</li>
<li>
<p>User logs in through browser page</p>
</li>
<li>
<p>Piconso shows feedback message for success</p>
</li>
<li>
<p>User uploads a photo</p>
</li>
<li>
<p>Piconso contacts Google Photos and uploads the photo</p>
</li>
<li>
<p>Piconso shows feedback for successful upload</p>
<div class="paragraph">
<p>Use case ends.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Extensions</strong></p>
</div>
<div class="ulist none">
<ul class="none">
<li>
<p>3a. User does not login through browser window.</p>
<div class="ulist none">
<ul class="none">
<li>
<p>3a1. User can resume on any use case not involving Google interaction.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="ulist none">
<ul class="none">
<li>
<p>3b. Piconso loses internet connection.</p>
<div class="ulist none">
<ul class="none">
<li>
<p>3b1. Piconso informs user of disconnection and suggests for them to try again.</p>
<div class="paragraph">
<p>Use case resumes at step 1.</p>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="ulist none">
<ul class="none">
<li>
<p>5a. An error occurs while uploading.</p>
<div class="ulist none">
<ul class="none">
<li>
<p>5a1. Piconso informs user of upload failure and suggests for them to try again.</p>
<div class="paragraph">
<p>Use case resumes at step 5.</p>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="non-functional-requirements"><a class="link" href="#non-functional-requirements">Appendix D: Non Functional Requirements</a></h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Should work on any mainstream OS as long as it has Java 9 or higher installed.</p>
</li>
<li>
<p>A user with above average typing speed for regular English text (i.e. not code, not system admin commands) should be able to accomplish most of the tasks faster using commands than using the mouse.</p>
</li>
<li>
<p>Should have easy to understand and remember user commands.</p>
</li>
<li>
<p>Allows users to navigate directories efficiently.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="glossary"><a class="link" href="#glossary">Appendix E: Glossary</a></h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1"><a id="batch"></a> Batch</dt>
<dd>
<p>Images that are currently being viewed. For example, if there are 16 images in the current directory, the default "batch" viewed would be the first 10 photos. Upon a <code>next</code> command, the "batch" switches to the next 10.</p>
</dd>
<dt class="hdlist1"><a id="transformation"></a> Transformation</dt>
<dd>
<p>Action that is performed on an image</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="instructions-for-manual-testing"><a class="link" href="#instructions-for-manual-testing">Appendix F: Instructions for Manual Testing</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Given below are instructions to test Piconso manually.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
These instructions only provide a starting point for testers to work on; testers are expected to do more <em>exploratory</em> testing.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="launch-and-shutdown"><a class="link" href="#launch-and-shutdown">F.1. Launch and Shutdown</a></h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Initial launch</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Download the jar file and copy into an empty folder</p>
</li>
<li>
<p>Double-click the jar file<br>
Expected: Shows the GUI with a set of sample contacts. The window size may not be optimum.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Saving window preferences</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Resize the window to an optimum size. Move the window to a different location. Close the window.</p>
</li>
<li>
<p>Re-launch the app by double-clicking the jar file.<br>
Expected: The most recent window size and location is retained.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="changing-a-directory"><a class="link" href="#changing-a-directory">F.2. Changing a directory</a></h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Traversing between directories</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Prerequisites: Users is aware of the current directory they are in from the status bar footer.</p>
</li>
<li>
<p>Test case: <code>cd Desktop</code><br>
Expected: User is now in Desktop. The full path of Desktop is shown in the status message. The current directory in the status bar is updated.</p>
</li>
<li>
<p>Test case: <code>cd ..</code><br>
Expected: User is now in the previous directory. The full path is shown in the status message. The current directory in the status bar is updated.</p>
</li>
<li>
<p>Test case (only for Windows): <code>cd C://Users</code><br>
Expected: User is now in <code>C:/Users</code>. The full path is shown in the status message. The current directory in the status bar is updated.</p>
</li>
<li>
<p>Test case: <code>cd</code><br>
Expected: User is unable to traverse to any directory. Error message is shown in the status message. The status bar remains the same.</p>
</li>
<li>
<p>Other incorrect cd commands to try: <code>cd C://xxxx</code>, <code>cd xxxx</code> (where xxxx is a non-existent directory)<br>
Expected: Similar to previous.</p>
</li>
</ol>
</div>
</li>
<li>
<p><code>Tab</code> function to auto-complete directory name</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Prerequisites: Users is aware of the current directory they are in from the status bar footer.</p>
</li>
<li>
<p>Test case: <code>cd Desk</code><br>
Expected: <code>cd Desktop</code> is shown in the command box.</p>
</li>
<li>
<p>Test case (only for Windows): <code>cd C://Use</code><br>
Expected (only in Windows): <code>cd C://Users</code> is shown in the command box.</p>
</li>
<li>
<p>Test case: <code>cd 12345</code><br>
Expected: User does not observe any changes.</p>
</li>
<li>
<p>Other incorrect cd commands to try: <code>cd C://xxxx</code>, <code>cd xxxx</code> (where xxxx is a non-existent directory)<br>
Expected: Similar to previous.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="opening-an-image"><a class="link" href="#opening-an-image">F.3. Opening an image</a></h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Opening images in current directory</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Prerequisites: <code>cd</code> into a existing directory with at at least 5 images to view the first batch of images in the directory.</p>
</li>
<li>
<p>Test case: <code>open 1</code><br>
Expected: The first image in the <code>Film Reel</code> is displayed on the GUI. The image opened is shown in the status message.</p>
</li>
<li>
<p>Test case: <code>open 3</code><br>
Expected: The third image in the <code>Film Reel</code> is displayed on the GUI. The image opened is shown in the status message.</p>
</li>
<li>
<p>Test case: <code>open 0</code><br>
Expected: The user is unable to open the image. Error message is shown in the status message.</p>
</li>
<li>
<p>Other incorrect open commands to try: <code>open 11</code> (as index exceeds batch size of 10), <code>open x</code> (where x exceeds the total images in the current batch),
<code>open abc</code><br>
Expected: Similar to previous.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="traversing-between-image-batches"><a class="link" href="#traversing-between-image-batches">F.4. Traversing between image batches</a></h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Accessing the next/previous batch of images</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Prerequisites: <code>cd</code> into a existing directory with 11-20 images to view the first batch of 10 images in the directory.</p>
</li>
<li>
<p>Test case: <code>next</code><br>
Expected: The next 10 images in the directory is shown in the <code>Film Reel</code>. The current batch and remaining number of images is shown in the status message.</p>
</li>
<li>
<p>Test case: <code>next</code><br>
Expected: The user is unable to access the next batch of images as it exceeds the total number of images in the list. Error message is shown in the status message.</p>
</li>
<li>
<p>Test case: <code>prev</code><br>
Expected: The first 10 images in the directory is shown in the <code>Film Reel</code>. The current batch and remaining number of images is shown in the status message.</p>
</li>
<li>
<p>Test case: <code>prev</code><br>
Expected: The user is unable to access the prev batch of images as it is already at the start of the list. Error message is shown in the status message.</p>
</li>
<li>
<p>Other incorrect next commands to try: <code>prev</code> (when list the already at the start), <code>next</code> (when user is viewing the end of list)<br>
Expected: Similar to previous.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="applying-transformation-to-image"><a class="link" href="#applying-transformation-to-image">F.5. Applying transformation to image</a></h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Apply build in transformation to image</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Prerequisites: <code>cd</code> into a existing directory with at at least 1 image to view the first batch of images in the directory.</p>
</li>
<li>
<p>Test case: <code>apply blur 0x8</code><br>
Expected: the image in the preview panel is blurred, the <code>blur 0x8</code> is shown in the history panel</p>
</li>
<li>
<p>Test case: <code>apply rotate 180</code><br>
Expected: the image in the preview panel is rotated 180 degrees, the <code>rotate 180</code> is shown in the history panel</p>
</li>
<li>
<p>Test case: <code>apply blur</code><br>
Expected: the image in the preview panel does not change, invalid message will be shown, command usage will be shown.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="applying-raw-transformation-to-image"><a class="link" href="#applying-raw-transformation-to-image">F.6. Applying raw transformation to image</a></h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Apply raw transformation to image</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Prerequisites: <code>cd</code> into a existing directory with at at least 1 image to view the first batch of images in the directory.</p>
</li>
<li>
<p>Test case: <code>apply raw blur 0x8</code><br>
Expected: the image in the preview panel does not change, invalid operation message will be shown, nothing will be shown in the history panel.</p>
</li>
<li>
<p>Test case: <code>apply raw -blur 0x8</code><br>
Expected: the image in the preview panel is blurred, the <code>[-blur 0x8]</code> is shown in the history panel.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="creating-new-transformation"><a class="link" href="#creating-new-transformation">F.7. Creating new transformation</a></h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a new transformation</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test case: <code>create blurSample blur|0x8</code><br>
Expected: message for new transformation created will be shown.</p>
</li>
<li>
<p>Test case: <code>create blurSample blur</code><br>
Expected: invalid argument message will be shown, command usage message will be shown.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="apply-a-customised-transformation"><a class="link" href="#apply-a-customised-transformation">F.8. Apply a customised transformation</a></h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Apply a customised transformation</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Prerequisites: customised transformation <code>blurSample</code> has been created already.</p>
</li>
<li>
<p>Test case: <code>apply @blurSample</code><br>
Expected: the image in the preview panel is blurred, the <code>@blurSample</code> is shown in the history panel.</p>
</li>
<li>
<p>Test case: <code>apply blurSample</code><br>
Expected: the image in the preview panel does not change, the invalid operation message will be shown.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="undoing-and-redoing-transformations"><a class="link" href="#undoing-and-redoing-transformations">F.9. Undoing and Redoing transformations</a></h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Undoing transformations</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Positive Tests</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Prerequisites: An image has been opened, with several transformations applied.</p>
</li>
<li>
<p>Test case: <code>undo</code><br>
Expected: The image&#8217;s latest transformation in the current layer is undone.</p>
</li>
<li>
<p>Test case: <code>undo-all</code><br>
Expected: All of the image&#8217;s transformations in the current layer are undone (current layer in original state).</p>
</li>
</ol>
</div>
</li>
<li>
<p>Negative Tests</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Prerequisites: An image has been opened, with no transformations applied. Or image has transformations applied, but all are undone.</p>
</li>
<li>
<p>Test case: <code>undo</code><br>
Expected: Error message to user as there are no transformations to undo.</p>
</li>
<li>
<p>Test case: <code>undo-all</code><br>
Expected: Error message to user as there are no transformations to undo.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Redoing transformations</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Positive Tests</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Prerequisites: An image has been opened, with several transformations applied and several transformations undone.</p>
</li>
<li>
<p>Test case: <code>redo</code><br>
Expected: The image&#8217;s last undone transformation in the current layer is redone.</p>
</li>
<li>
<p>Test case: <code>redo-all</code><br>
Expected: All of the image&#8217;s undone transformations in the current layer is redone.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Negative Tests</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Prerequisites: An image has been opened, with several transformations applied and no transformations undone. Or image is opened with no transformations applied.</p>
</li>
<li>
<p>Test case: <code>redo</code><br>
Expected: Error message to user as there are no transformations to redo.</p>
</li>
<li>
<p>Test case: <code>redo-all</code><br>
Expected: Error message to user as there are no transformations to redo.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="save-a-image"><a class="link" href="#save-a-image">F.10. Save a image</a></h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>save a edited image</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Prerequisites: some transformations have been applied to an image.</p>
</li>
<li>
<p>Test case: <code>save</code><br>
Expected: The modified image will be save to the original image.</p>
</li>
<li>
<p>Test case: <code>save test.jpg</code><br>
Expected: A new image test.jpg will be created in the current directory. The modified image will be saved to test.jpg.</p>
</li>
<li>
<p>Test case: <code>save test.test</code><br>
Expected: A invalid format message will be shown, and the image will not be saved.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="canvases-and-layers"><a class="link" href="#canvases-and-layers">F.11. Canvases and Layers</a></h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Canvas manipulation</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Positive cases</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Test case: <code>canvas size 1000x1000</code><br>
Expected: The canvas should now a size of 1000 by 1000 pixels.</p>
</li>
<li>
<p>Test case: <code>canvas bgcolor none</code><br>
Expected: The canvas should now have a transparent background. If the canvas is too small, the background shouldn&#8217;t even be visible.</p>
</li>
<li>
<p>Test case: <code>canvas auto-resize on</code><br>
Expected: The canvas should now expand to ensure that all layers are within the frame. The canvas should ignore all options provided by <code>size</code>.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Negative cases</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Test case: <code>canvas bgcolor invalid</code><br></p>
</li>
<li>
<p>Test case: <code>canvas size -123x456</code><br></p>
</li>
<li>
<p>Test case: <code>canvas auto-resize invalid</code><br>
Expected: the help message demonstrating proper usage of the command should show up in the console output panel.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Layer manipulation</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Positive cases</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Test case: <code>layer add 1</code><br>
Expected: The first image in the <code>Film Reel</code> is added as a new layer with on top of all existing layers.</p>
</li>
<li>
<p>Test case: <code>layer remove 2</code><br>
Expected: The second layer in the canvas should be removed if the following conditions are satisfied:</p>
<div class="olist upperalpha">
<ol class="upperalpha" type="A">
<li>
<p>The layer index provided is valid.</p>
</li>
<li>
<p>The layer is not currently selected.</p>
</li>
<li>
<p>The layer is not the last one in the canvas.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Test case: <code>layer select 2</code><br>
Expected: The layer at index 2 is selected to be the current working layer, highlighted in the <code>Layers Panel</code> and be the target of all subsequent transformations if the following condition is satisfied:</p>
<div class="olist upperalpha">
<ol class="upperalpha" type="A">
<li>
<p>The layer index provided is valid.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Test case: <code>layer swap 1 2</code><br>
Expected: The layers at index 1 and 2 should be swapped if the following conditions are satisfied:</p>
<div class="olist upperalpha">
<ol class="upperalpha" type="A">
<li>
<p>The layer indexes provided are valid.</p>
</li>
<li>
<p>The layer indexes provided are distinct.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Test case: <code>layer position -400x400</code><br>
Expected: The top-left corner of the layer will be set to the coordinate provided. If the coordinates are too far out of the canvas and <code>auto-resize</code> isn&#8217;t turned on, clipping or complete invisibility should occur. Note that negative coordinates are accepted and this is intended behavior.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Negative cases</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Test case: <code>layer add 11</code>.<br></p>
</li>
<li>
<p>Test case: <code>layer remove 1</code> when there is only one layer left in the canvas.</p>
</li>
<li>
<p>Test case: <code>layer remove 2</code> when index 2 is the layer that is selected.</p>
</li>
<li>
<p>Test case: <code>layer swap -1 -3</code>.</p>
</li>
<li>
<p>Test case: <code>layer swap 1 1</code>.</p>
</li>
<li>
<p>Test case: <code>layer position invalid</code>.<br>
Expected : A specific error message about the constraint violated should show up in the console output panel and no other operations should be performed.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
</div></div><div id="footer"><div class="container"><div id="footer-text">Last updated 2018-11-12 15:20:16 UTC</div></div></div></body></html>