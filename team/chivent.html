<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]--><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="Asciidoctor 1.5.6.1"><title>Ong Kai Le - Project Portfolio</title><link rel="stylesheet" href="../stylesheets/gh-pages.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css">
<link rel="stylesheet" href="../stylesheets/coderay-asciidoctor.css"></head><body class="article"><div id="site-header"><nav class="navbar navbar-light bg-light"><div class="container"><a class="navbar-brand" href="../index.html">Piconso</a><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="../UserGuide.html">User Guide</a></li><li class="nav-item"><a class="nav-link" href="../DeveloperGuide.html">Developer Guide</a></li><li class="nav-item"><a class="nav-link" href="../LearningOutcomes.html">LOs</a></li><li class="nav-item"><a class="nav-link active" href="../AboutUs.html">About Us</a></li><li class="nav-item"><a class="nav-link" href="../ContactUs.html">Contact Us</a></li><li class="navitem"><a class="nav-link" href="https://cs2103-ay1819s1-t09-3.github.io/main/index.html"><span class="fa fa-github fa-lg" aria-hidden="true"></span>&nbsp;View on GitHub</a></li></ul></div></nav></div><div id="header"><h1>Ong Kai Le - Project Portfolio</h1></div><div id="content"><div class="sect1">
<h2 id="project-piconso"><a class="link" href="#project-piconso">PROJECT: Piconso</a></h2>
<div class="sectionbody">
<hr>
</div>
</div>
<div class="sect1">
<h2 id="overview"><a class="link" href="#overview">Overview</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Piconso is an CLI-based (Command Line Interface) image editor designed and developed for quick and efficient image-editing.
Many of today&#8217;s top image editing softwares are often overloaded with features, and for those who just want to perform and learn basic image editing, the learning curve of these softwares is way too steep.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/Ui.png" alt="width:602">
</div>
<div class="title">Figure 1. A view of Piconso</div>
</div>
<div class="paragraph">
<p>Sporting a simplified CLI interface, it is easy to navigate and interact with Piconso through basic text commands. The product caters especially towards individuals familiar with CLI but at the same time, aims to be easy for new users such as photographers to pick up.</p>
</div>
<div class="paragraph">
<p>The application is Java-based and well documented, with its code quality ensured via a series of manual and unit tests. The following will detail more about my contributions to the development of Piconso.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="summary-of-contributions"><a class="link" href="#summary-of-contributions">Summary of contributions</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="strong-main-enhancement-strong-enabled-connectivity-to-google-photos"><a class="link" href="#strong-main-enhancement-strong-enabled-connectivity-to-google-photos"><strong>Main enhancement</strong>: Enabled connectivity to Google Photos</a></h3>
<div class="paragraph">
<p>Google Photos has become a popular platform that is used by many to safely store and share their images. As such, allowing connectivity to Google allows users to quickly retrieve their stored images on Google Photos for offline editing without having to leave Piconso.</p>
</div>
<div class="paragraph">
<p>This enhancement provides users with the ability to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Traverse Google Photos and filter images by album</p>
</li>
<li>
<p>Download an image or an entire album</p>
</li>
<li>
<p>Upload an image or an entire folder</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>With this feature, the user can instantly download, edit and upload his edited photo for safe storage and quick sharing to other users. This especially adds value to users such as photographers or developers, who may have a large batch of images stored on the cloud that they would like to edit.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Highlights</em>: This enhancement runs authentication asynchronously such that if a login request is not followed through, it leaves the main application unaffected. Additionally, the upload, download and list features all have multiple command variants for user convenience.</p>
</li>
<li>
<p><em>Credit</em>: Google Photos Java Client API and Google OAuth API have been used throughout Google related commands. Certain parts of the aspect that allows login to Google Photos was also based upon the <a href="https://github.com/google/java-photoslibrary/blob/master/sample/src/main/java/com/google/photos/library/sample/demos/AlbumDemo.java">example found here</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="strong-minor-enhancements-strong"><a class="link" href="#strong-minor-enhancements-strong"><strong>Minor enhancements</strong>:</a></h3>
<div class="paragraph">
<p><strong>Implemented a ls command</strong></p>
</div>
<div class="paragraph">
<p>Similar to <code>ls</code> used in consoles, the ls command I implemented allows users to view the content of the directory they are currently in. However, the <code>ls</code> implemented in this project only lists folders and images so as to prevent user confusion.</p>
</div>
<div class="paragraph">
<p><strong>Created the initial User Interface (UI)  and logic for HistoryListPanel</strong></p>
</div>
<div class="paragraph">
<p>The HistoryListPanel (as seen on the upper left of the application) provides a way for users to keep track of the transformations they have performed thus far on the layer in a visual form.
The logic previously handled only transformations on one layer, but was later changed by the team after the implementation of layers to incorporate it.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Highlights</em>: The list currently constantly highlights the last performed transformation, and selection on the panel has been disabled to prevent user confusion.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Created UI and logic for Film Reel</strong></p>
</div>
<div class="paragraph">
<p>We came to a decision that viewing all images at once would be too confusing for the user, and thus we decided to show the image by <em>batches</em>
such that a user can only view 10 images at once, and navigate via <code>next</code> and <code>preview</code> commands.</p>
</div>
<div class="paragraph">
<p>The FilmReel (as seen on the lower left of the application) shows the currently viewed batch of images in the directory.  It provides an easy way for users to preview their images and know the image index associated with it.</p>
</div>
</div>
<div class="sect2">
<h3 id="strong-code-contributed-strong"><a class="link" href="#strong-code-contributed-strong"><strong>Code contributed</strong>:</a></h3>
<div class="paragraph">
<p>Here are links to my contributed code: [<a href="https://github.com/CS2103-AY1819S1-T09-3/main/commits?author=chivent">All commits</a>] [<a href="https://nus-cs2103-ay1819s1.github.io/cs2103-dashboard/#=undefined&amp;search=chivent">Project Code Dashboard</a>]</p>
</div>
</div>
<div class="sect2">
<h3 id="strong-other-contributions-strong"><a class="link" href="#strong-other-contributions-strong"><strong>Other contributions</strong>:</a></h3>
<div class="paragraph">
<p>Aside from my main contributions, I have also participated in performing the following general tasks</p>
</div>
<div class="paragraph">
<p><strong>Project management:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Helped manage tagging of milestone code (v1.1-v1.2)</p>
</li>
<li>
<p>Participated in creating and tagging issues, and merging/reviewing PRs</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Enhancements to existing features:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Updated the StatusFooterBar UI to display the current directory and google connectivity status (Pull requests <a href="https://github.com/CS2103-AY1819S1-T09-3/main/pull/80">#80</a>)</p>
</li>
<li>
<p>Renamed "AddressBook" instances from base project to relate to our application instead.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Documentation:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Added detailed implementation documentation for the Google-related features in the Developer Guide, including diagrams and images: <a href="https://github.com/CS2103-AY1819S1-T09-3/main/pull/131">#131</a>, <a href="https://github.com/CS2103-AY1819S1-T09-3/main/pull/195">#195</a></p>
</li>
<li>
<p>Updated the User Guide for Google-related features: <a href="https://github.com/CS2103-AY1819S1-T09-3/main/pull/103">#103</a>, <a href="https://github.com/CS2103-AY1819S1-T09-3/main/pull/131">#131</a></p>
</li>
<li>
<p>Performed general updates in DeveloperGuide, AboutUs and README documents <a href="https://github.com/CS2103-AY1819S1-T09-3/main/pull/200">#200</a>, <a href="https://github.com/CS2103-AY1819S1-T09-3/main/pull/203">#203</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Community:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>PRs merged: <a href="https://github.com/CS2103-AY1819S1-T09-3/main/pull/108">#108</a>, <a href="https://github.com/CS2103-AY1819S1-T09-3/main/pull/110">#110</a></p>
</li>
<li>
<p>PRs reviewed: <a href="https://github.com/CS2103-AY1819S1-T09-3/main/pull/44">#44</a>, <a href="https://github.com/CS2103-AY1819S1-T09-3/main/pull/37">#37</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="contributions-to-the-user-guide"><a class="link" href="#contributions-to-the-user-guide">Contributions to the User Guide</a></h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Given below are sections I have contributed to the User Guide.
They showcase my ability to write user-friendly documentation.</em></p></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="interact-with-google-photos-code-g-code"><a class="link" href="#interact-with-google-photos-code-g-code">Interact with Google Photos: <code>g</code></a></h3>
<div class="paragraph">
<p>Piconso allows you to connect to Google Photos so that you may easily upload and download photos for editing.</p>
</div>
<div class="paragraph">
<p>All Google-related commands will require a stable internet connection. Additionally as the following are internet-dependant, the commands will take a longer amount of time to execute as compared to the other offline features.</p>
</div>
<div class="paragraph">
<p>Connecting to Google Photos is <strong>NOT</strong> compulsory, it is simply an additional feature to supplement your experience with Piconso!</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The higher the amount of images involved in your google command, the longer amount of time commands will take to process.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="logs-in-to-google-photos-code-login-code"><a class="link" href="#logs-in-to-google-photos-code-login-code">Logs in to Google Photos: <code>login</code></a></h4>
<div class="paragraph">
<p>Format : <code>login</code> &#8594; Allows you to connect to Google Photos through a browser redirect</p>
</div>
</div>
<div class="sect3">
<h4 id="traverses-google-photos-code-g-ls-code"><a class="link" href="#traverses-google-photos-code-g-ls-code">Traverses Google Photos: <code>g ls</code></a></h4>
<div class="paragraph">
<p>Format: <code>g ls (parameters)</code> &#8594; Lists the images you have in Google Photos.</p>
</div>
<div class="paragraph">
<p>There are 3 ways you can list your images.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>g ls</code>: Lists all images in your account<br></p>
</li>
<li>
<p><code>g ls /a</code>: Lists all your available albums<br></p>
</li>
<li>
<p><code>g ls &lt;ALBUM_NAME&gt;</code>: Lists all images in specified album from Google Photos.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="paragraph">
<p><code>* g ls &lt;Vacation&gt;</code> - Lists all images in the Vacation album.</p>
</div>
</div>
<div class="sect3">
<h4 id="downloads-photos-from-google-photos-code-g-dl-code"><a class="link" href="#downloads-photos-from-google-photos-code-g-dl-code">Downloads photos from Google Photos: <code>g dl</code></a></h4>
<div class="paragraph">
<p>Format: <code>g dl [parameters]</code> &#8594; Downloads your specified image from Google Photos.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>All photos will be downloaded to the currently opened local directory.<br>
Any files with duplicate naming existing in the targeted directory <strong>WILL</strong> be replaced</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>There are 3 ways you can list your images:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>g dl /i&lt;IMAGE_NAME&gt;</code> : Downloads the specified image from Google Photos<br></p>
</li>
<li>
<p><code>g dl /a&lt;ALBUM_NAME&gt;</code> : Downloads all images from the specified album into Google Photos.<br></p>
</li>
<li>
<p><code>g dl /a&lt;ALBUM_NAME&gt; /i&lt;IMAGE_NAME&gt;</code> : Downloads a specific photo from a specific album in Google Photos.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>g dl /i&lt;Beach.png&gt;</code> - Downloads Beach.png<br></p>
</li>
<li>
<p><code>g dl /a&lt;Vacation&gt;</code> - Downloads all photos from Vacation album<br></p>
</li>
<li>
<p><code>g dl /a&lt;Vacation&gt; /i&lt;Beach.png&gt;</code> - Downloads Beach.png from Vacation album<br></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="uploads-photos-to-google-photos-code-g-ul-code"><a class="link" href="#uploads-photos-to-google-photos-code-g-ul-code">Uploads photos to Google Photos: <code>g ul</code></a></h4>
<div class="paragraph">
<p>Format: <code>g ul [parameters]</code> &#8594; Uploads your specified image to Google Photos.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>All uploaded photos will be automatically categorised into album 'Piconso Uploads' in Google Photos. Any duplicate images in Google Photos will be replaced by the new upload with the old name.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>There are 2 ways you can list your images:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>g ul &lt;IMAGE_NAME&gt;</code> : Uploads the specified image to Google Photos<br></p>
</li>
<li>
<p><code>g ul all</code> : Uploads all images in current opened directory to Google Photos.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>g ul &lt;Cat.png&gt;</code> - Uploads Cat.png<br></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="logs-out-of-google-photos-code-logout-code"><a class="link" href="#logs-out-of-google-photos-code-logout-code">Logs out of Google Photos: <code>logout</code></a></h3>
<div class="paragraph">
<p>Format: <code>logout</code> &#8594; Disconnects you from Google Photos</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="contributions-to-the-developer-guide"><a class="link" href="#contributions-to-the-developer-guide">Contributions to the Developer Guide</a></h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Given below are sections I contributed to the Developer Guide.
They showcase my ability to write technical documentation and the technical depth of my contributions to the project.</em></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="implementation-google-features"><a class="link" href="#implementation-google-features">Implementation: Google features</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="overall-introduction"><a class="link" href="#overall-introduction">Overall Introduction</a></h3>
<div class="paragraph">
<p>The Google commands allow for access to <a href="https://developers.google.com/photos/library/guides/get-started-java">Google Photos</a> through a logged-in instance of the user, and are held up by two main components.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>PhotosLibraryClientFactory</code> - Initiates and carries out the login process. Produces a <code>PhotoHandler</code> instance, which handles matters related to Google commands.</p>
</li>
<li>
<p><code>PhotoHandler</code> - Mainly consists of a <code>PhotoLibraryClient</code> instance, the user&#8217;s logged in state, and 3 maps for storing images, albums, and specific images from an album. Performs all explicit calls to Google Photos through the <code>PhotosLibraryClient</code> instance and parses results.</p>
<div class="ulist">
<ul>
<li>
<p>The <code>PhotoHandler</code> instance is later accessed through <code>Model#getPhotoHandler()</code> and <code>Model#setPhotoHandler()`</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>There are 6 main google-related commands. The first two commands login/logout a user, and the latter 4 are mostly overloaded command types with <code>GoogleCommand</code> as the abstract parent class.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>LoginCommand</code> - Logs in user to their Google Account.</p>
</li>
<li>
<p><code>LogoutCommand</code> - Logs a user out of their Google Account.</p>
</li>
<li>
<p><code>GoogleLsCommand</code> - Lists files in Google Photos.</p>
</li>
<li>
<p><code>GoogleRefreshCommand</code> - Refreshes the displayed list from Google Photos.</p>
</li>
<li>
<p><code>GoogleDlCommand</code> - Downloads the specified image(s) from Google Photos to the user&#8217;s currently opened local directory.</p>
</li>
<li>
<p><code>GoogleUploadCommand</code> - Uploads the specified image(s) from the user&#8217;s currently opened local directory to Google Photos.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We have connected and generated <code>client_credentials.json</code> via our own Google Account to enable usage of Google Photos API in Piconso. It is recommended that you <a href="https://developers.google.com/photos/library/guides/get-started-java">configure</a> Piconso to use Google Photos Library API with your own account rather than the provided.<br></p>
</div>
<div class="paragraph">
<p>If you are not familiar with how Google Photos works, it would be advisable to first try out Google Photos as a consumer before proceeding.</p>
</div>
</div>
<div class="sect2">
<h3 id="login-login-command"><a class="link" href="#login-login-command">Login (login) Command</a></h3>
<div class="sect3">
<h4 id="current-implementation"><a class="link" href="#current-implementation">Current Implementation</a></h4>
<div class="paragraph">
<p>The Login command currently authenticates a user via Google OAuth. To learn more about the implementation of OAuth methods, you may refer to <a href="https://developers.google.com/identity/protocols/OAuth2#installed">O-Auth Explanation</a> and <a href="https://developers.google.com/api-client-library/java/google-api-java-client/oauth2#installed_applications">Google API examples</a>. As the workings of Google OAuth are rather complicated, it is suggested that you first go through the examples/documentations in those links.<br></p>
</div>
<div class="paragraph">
<p>The following static methods of <code>PhotosLibraryClientFactory</code> will be involved:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>createClient()</code> - Creates a PhotoLibrary instance, contains calls to Google OAuth related methods.</p>
</li>
<li>
<p><code>createPhotosLibraryClient(Credentials)</code> - Creates an instance of Google&#8217;s PhotosLibraryClient using the provided credentials.</p>
</li>
<li>
<p><code>getUserEmail(Credential)</code> - Retrieves the user&#8217;s email from Google+.</p>
</li>
<li>
<p><code>loginUserIfPossible()</code> - Logs in a user if a valid credential file can be found during start up.</p>
</li>
<li>
<p><code>logoutUserIfPossible()</code> - Logs a user out if a credential file can be found.</p>
</li>
<li>
<p><code>checkUserLogin()</code> - Checks if any users are currently logged in.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Below are some examples on how the login command will work.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If connection to the internet is lost at any point during authentication with Google&#8217;s server, login will fail and an error message will be sent to user as feedback.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="scenario-1-explicit-code-login-code-command-executed-user-not-logged-in-yet"><a class="link" href="#scenario-1-explicit-code-login-code-command-executed-user-not-logged-in-yet">Scenario 1: Explicit <code>login</code> command executed, user not logged in yet.</a></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The user executes a <code>login</code> command.</p>
</li>
<li>
<p>The login command calls <code>Model#getPhotoHandler()</code> and checks if a PhotoHandler instance already exists. If not, it calls static method <code>PhotoLibraryClientFactory#createClient()</code> to set up the requirements for log in and redirects the user to the browser.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This occurs asynchronously, and a user can close the redirect window and proceed as usual with the application if they have changed their mind.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>User logs in through redirect window and a refresh token is returned and stored. PhotoLibraryClientFactory class then calls <code>PhotoLibraryClientFactory#createPhotosLibraryClient()</code> and <code>PhotoLibraryClientFactory#getUserEmail()</code> to instantiate a <code>PhotoHandler</code> instance</p>
</li>
<li>
<p>The <code>PhotoHandler</code> instance is set by model as <code>Model#photoLibrary</code>, and confirmation of login is sent to user.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The following sequence diagram illustrates how the above steps work:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/LoginSequenceDiagram.png" alt="LoginSequenceDiagram" width="1000">
</div>
<div class="title">Figure 2. Sequence Diagram for LoginCommand</div>
</div>
</div>
<div class="sect3">
<h4 id="scenario-2-implicit-login-where-piconso-auto-logs-in-user-upon-re-launch"><a class="link" href="#scenario-2-implicit-login-where-piconso-auto-logs-in-user-upon-re-launch">Scenario 2: Implicit login, where Piconso auto logs in user upon re-launch</a></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Upon Piconso start up, <code>PhotoLibraryClientFactory#loginUserIfPossible()</code> is run by <code>ModelManager</code><br></p>
</li>
<li>
<p>The method checks for stored credentials (refresh token), and logs in user via <code>PhotoLibraryClientFactory#createClient()</code> if possible, else the log in process is skipped.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In both scenarios, whenever a valid refresh token is found stored the user is logged in without having to face browser re-direct again. At no point in time will we be storing a user&#8217;s actual credentials, but only a refresh token that allows us to keep a user logged in, actual credentials are handled by Google OAuth<br></p>
</div>
</div>
<div class="sect3">
<h4 id="design-considerations"><a class="link" href="#design-considerations">Design Considerations</a></h4>
<div class="paragraph">
<p><strong>Asynchronous Login</strong>: By default, as long as a user has not logged in after <code>login</code> command is launched, Piconso freezes and waits for user input.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Current Solution</em>: An asynchronous approach has been implemented instead such that Piconso continues working as usual even if the user has not logged in. Once a user is logged in, Piconso will simply show feedback.</p>
</li>
<li>
<p><em>Cons</em>: Google allows max 3 login requests to be made in an interval, hence the <code>login</code> command will stop redirecting after 3 consecutive logins made in a short period of time. While it is unlikely this will pose a problem for users, it would be advisable to display the redirect URL in the Piconso CLI during future development.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="logout-logout-command"><a class="link" href="#logout-logout-command">Logout (logout) Command</a></h4>
<div class="paragraph">
<p>The logout command deletes the stored credential file (and any other login-related files) if it exists, and does nothing if it does not. Upon deleting the file, the user will no longer have a refresh token to stay logged in, and thus is effectively logged out.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="googlelscommand-ls"><a class="link" href="#googlelscommand-ls">GoogleLsCommand (ls)</a></h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For all Google-related Commands (excluding login and logout), their command word is appended with a g (i.e <code>g ls</code>). Thus all children of <code>GoogleCommand</code> are first passed through a <code>GoogleCommandParser</code> to determine its type.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="current-implementation-2"><a class="link" href="#current-implementation-2">Current Implementation</a></h4>
<div class="paragraph">
<p>The <code>GoogleLsCommand</code> allows users to browse through their stored images on Google Photos. Currently, it is overloaded with three types of commands the user can type</p>
</div>
<div class="paragraph">
<p><code>g ls</code> &#8594; Lists all photos in user&#8217;s Google Photos, takes a longer amount of time depending on the number of images stored.<br>
<code>g ls /a</code> &#8594; Lists all albums in user&#8217;s Google Photos.<br>
<code>g ls &lt;ALBUM_NAME&gt;</code> &#8594; Lists all photos in specified album from Google Photos.</p>
</div>
<div class="paragraph">
<p>As such, parsing will be done twice. Once by <code>GoogleCommandParser</code>, and another within <code>GoogleLsCommand</code> itself.</p>
</div>
<div class="paragraph">
<p>The following methods and components of <code>PhotoHandler</code> will be involved:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>imageMap</code> - Map&lt;String, MediaItem&gt; that contains the list of images retrieved from Google API call. Uses image names as keys.</p>
</li>
<li>
<p><code>albumMap</code> - Map&lt;String, Album&gt; that contains the list of albums retrieved from Google API call. Uses album names as keys.</p>
</li>
<li>
<p><code>specificAlbumMap</code> - Map&lt;String, MediaItem&gt; that contains the list of images from a specific album retrieved from Google API call. Uses image names as keys.</p>
</li>
<li>
<p><code>getUniqueName(Map, String, String)</code> - Checks for existence of a name in the map. If it exists, append a sutiable index at the end of the name.</p>
</li>
<li>
<p><code>refreshLists()</code> - Re-retrieves all images and albums from Google Photos and updates <code>imageMap</code> and <code>albumMap</code></p>
</li>
<li>
<p><code>returnAllAlbumsList()</code> - Calls <code>retrieveAllAlbumsFromGoogle()</code> and returns a <code>List</code> of Album names for easy display</p>
</li>
<li>
<p><code>retrieveAllAlbumsFromGoogle()</code> - Makes a Google API call and retrieves all albums stored in Google Photos, storing it in <code>albumMap</code>.</p>
<div class="ulist">
<ul>
<li>
<p>Similar methods for other variants exist, but only methods used for the example below will be listed.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="example-first-call-for-code-g-ls-a-code-where-user-wants-to-list-all-albums-in-google-photos"><a class="link" href="#example-first-call-for-code-g-ls-a-code-where-user-wants-to-list-all-albums-in-google-photos">Example: First call for <code>g ls /a</code>, where user wants to list all albums in Google Photos.</a></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The user executes a <code>g ls /a</code> command.</p>
</li>
<li>
<p>The command goes through parsing, firstly by <code>GoogleCommandParser</code> and secondly filtered by GoogleLsCommand. It is determined to be for listing albums, and <code>model.getPhotoHandler().returnAllAlbumsList()</code> is called.</p>
</li>
<li>
<p>Within that method, it makes a request to Google Photos, retrieves a <code>List&lt;Album&gt;</code>, and stores them in a <code>Map&lt;String, Album&gt;</code> within the PhotoHandler instance, with each key being the album name, any duplicate names are renamed.</p>
</li>
<li>
<p>The entire list is converted into a String, and returned to the <code>CommandBox</code> UI as feedback to the user</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The following activity diagram illustrates how the above steps work:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/GoogleLsActivityDiagram.png" alt="GoogleLsActivityDiagram" width="1000">
</div>
<div class="title">Figure 3. Activity Diagram for GoogleLsCommand</div>
</div>
<div class="paragraph">
<p>The process is similar for the other 2 variants, except images or images from a specific album are retrieved instead. All retrieved results are always stored in their respective maps.</p>
</div>
</div>
<div class="sect3">
<h4 id="design-considerations-2"><a class="link" href="#design-considerations-2">Design Considerations</a></h4>
<div class="paragraph">
<p><strong>Performance Issues</strong>: The larger the amount of pictures stored in Google Photos, the longer amount of time a <code>g ls</code> command takes.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Alternative 1</em>: Re-retrieve the list of photos/albums upon every <code>ls</code> call</p>
<div class="ulist">
<ul>
<li>
<p>Pro: Displayed list of images/albums is always up-to-date.</p>
</li>
<li>
<p>Con: Each Google Photos API call takes a notable amount of time to execute. Constantly re-retrieving the list of images/albums causes multiples API calls and incurs heavy waiting time for users.</p>
</li>
</ul>
</div>
</li>
<li>
<p><em>Alternative 2 (Current)</em>: Adding a refresh command. As it is not likely that the set of photos in Google Photos will constantly change, the list of images/albums is retrieved and stored upon first <code>g ls</code> call and is only refreshed upon <code>g refresh</code>.</p>
<div class="ulist">
<ul>
<li>
<p>Pro: Shortens the waiting time for user on every <code>g ls</code> call</p>
</li>
<li>
<p>Con: More work on user&#8217;s behalf to remember to refresh.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Duplicated Naming</strong>: Google Photos allows for multiples images and albums to be stored with the same name, making it difficult to list item names as names might overlap.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Alternative 1 (Current)</em>: Upon a retrieval of images/albums from Google, image/album names are checked for duplicates. Every duplicate will have a suitable index appended at the end of its original name to ensures that unique naming occurs.</p>
<div class="ulist">
<ul>
<li>
<p>Con: If there are multiple images with the same name, the process of any <code>g ls</code> or <code>g refresh</code> will take a longer time to run.</p>
</li>
</ul>
</div>
</li>
<li>
<p><em>Alternative 2</em>: Instead of storing the name of the image/album as the key inside the Map, its unique ID (that is retrieved together with the files from Google) can be used instead.</p>
<div class="ulist">
<ul>
<li>
<p>Con: The ID too complicated for a user to input and remember.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Album Traversal: How to display and use Albums from Google</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Alternative 1</em>: Treat the album as a category, thus <code>g ls &lt;ALBUM_NAME&gt;</code> acts as a filter that filters photos by category.</p>
<div class="ulist">
<ul>
<li>
<p>Pro: Easy for users to understand and remember.</p>
</li>
<li>
<p>Con: The command to download from an album needs to be extended such that users need to specify which album the image to download is in i.e <code>g dl /a&lt;Album&gt; /i&lt;image.png&gt;</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><em>Alternative 2</em>: Handle the concept of albums like directories, such that a user can cd in and out of an album.</p>
<div class="ulist">
<ul>
<li>
<p>Con: Confusing for users to concurrently navigate and differentiate both google and local directories.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="googlerefreshcommand-refresh"><a class="link" href="#googlerefreshcommand-refresh">GoogleRefreshCommand (refresh)</a></h4>
<div class="paragraph">
<p>The refresh command re-retrieves and stores the list of images/albums from Google Photos into respective maps in <code>Model#getPhotoHandler()</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="googledlcommand-dl"><a class="link" href="#googledlcommand-dl">GoogleDlCommand (dl)</a></h3>
<div class="sect3">
<h4 id="current-implementation-3"><a class="link" href="#current-implementation-3">Current Implementation</a></h4>
<div class="paragraph">
<p>The GoogleDlCommand allows users to download their stored images on Google Photos. Currently, it is overloaded with three types of commands the user can type</p>
</div>
<div class="paragraph">
<p><code>g dl /i&lt;IMAGE_NAME&gt;</code>: Downloads specified image from Google Photos<br>
<code>g dl /a&lt;ALBUM_NAME&gt;</code>: Downloads all images from specified album in Google Photos, takes a longer amount of time depending on the number of images stored in the album.<br>
<code>g dl /a&lt;ALBUM_NAME&gt; /i&lt;IMAGE_NAME&gt;</code>: Downloads a specific photo from a specific album in Google Photos.</p>
</div>
<div class="paragraph">
<p>As such, parsing will be done twice. Once by GoogleCommandParser, and another within GoogleDlCommand itself.</p>
</div>
<div class="paragraph">
<p>The following components of <code>PhotoHandler</code> will be involved:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>downloadImage(String, String, String)</code> - Ensures the request is valid and calls saveImageInDir()` if true.</p>
</li>
<li>
<p><code>saveImageInDir(MediaItem, String)</code> - Saves the image using the baseURL of the <code>MediaItem</code></p>
<div class="ulist">
<ul>
<li>
<p>Similar methods for other variants exist, but only methods used for the example below will be listed.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="example-g-dl-i-b-png"><a class="link" href="#example-g-dl-i-b-png">Example: g dl /i&lt;b.png&gt;`</a></h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For all upload/download related commands, the amount of time taken to process the task varies with the number of images to upload/download.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The user executes a <code>g dl /i&lt;b.png&gt;</code> command.</p>
</li>
<li>
<p>The command goes through parsing, firstly by <code>GoogleCommandParser</code> and secondly filtered by GoogleDlCommand. It is determined to be for downloading one image, and <code>model.getPhotoHandler().downloadImage()</code> is called.</p>
</li>
<li>
<p>Within that method, it makes a request to Google Photos with the image&#8217;s respective ID, and successfully downloads the image into the user&#8217;s local directory.</p>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
If the local directory contains any image with the same name as the one to download, the image in the local directory will be replaced.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Feedback of success is sent to the user</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/GoogleDlSequenceDiagram.png" alt="GoogleDlSequenceDiagram" width="800">
</div>
<div class="title">Figure 4. Sequence Diagram for GoogleDlCommand</div>
</div>
<div class="paragraph">
<p>The process is similar for the other 2 variants, except images or images from a specific album are downloaded instead.</p>
</div>
</div>
<div class="sect3">
<h4 id="design-considerations-3"><a class="link" href="#design-considerations-3">Design Considerations</a></h4>
<div class="paragraph">
<p><strong>Location of downloaded images</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Alternative 1 (Current)</em>: Download the image into user&#8217;s currently opened local directory.</p>
<div class="ulist">
<ul>
<li>
<p>Pro: User is able to easily find the new downloaded photo</p>
</li>
<li>
<p>Con: Images with the same name WILL be replaced and it will be messy when multiple photos are downloaded</p>
</li>
</ul>
</div>
</li>
<li>
<p><em>Alternative 2 (Recommended for future)</em>: Images are downloaded into a specific directory which can be navigated to and fro via quick commands (i.e <code>jump to PicDir</code>, <code>jump back PicDir</code>)</p>
<div class="ulist">
<ul>
<li>
<p>Pro: Easier for user to retrieve and view downloaded photos. Photos with the same name can also be safely replaced as they are likely earlier versions downloaded from Google Photos.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="googleuploadcommand-ul"><a class="link" href="#googleuploadcommand-ul">GoogleUploadCommand (ul)</a></h3>
<div class="sect3">
<h4 id="current-implementation-4"><a class="link" href="#current-implementation-4">Current Implementation</a></h4>
<div class="paragraph">
<p>The GoogleUploadCommand allows users to upload their images onto Google Photos. Currently, it is overloaded with two types of commands the user can type</p>
</div>
<div class="paragraph">
<p><code>g ul &lt;IMAGE_NAME&gt;</code>: Uploads specified image from currently opened directory to Google Photos<br>
<code>g ul all</code>: Uploads all images in currently open local directory.</p>
</div>
<div class="paragraph">
<p>As such, parsing will be done twice. Once by GoogleCommandParser, and another within GoogleUploadCommand itself.</p>
</div>
<div class="paragraph">
<p>As the implementation of GoogleUploadCommand is mostly dependent on understanding of the upload aspects of Google Photos API, an example will not be given. Please refer to <a href="https://developers.google.com/photos/library/guides/upload-media">this link</a>.</p>
</div>
<div class="paragraph">
<p>The following components of <code>PhotoHandler</code> will be involved:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>uploadImage(String, String)</code> - Uploads the image from the current opened local directory.</p>
</li>
<li>
<p><code>retrievePiconsoAlbum()</code> - Retrieves the ID of the Piconso Album in Google Photos. If it does not exist, command creates one.</p>
</li>
<li>
<p><code>uploadMediaItemsToGoogle(List&lt;NewMediaItem&gt;)</code> - Highly Google Photos API based, returns a <code>NewMediaItem</code></p>
</li>
<li>
<p><code>generateNewMediaImage(String, String)</code> - Highly Google Photos API based, carries out actual upload to Google Photos with NewMediaItem.</p>
<div class="ulist">
<ul>
<li>
<p>Similar methods for other variants exist, but only methods used for the example below will be listed.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="design-considerations-4"><a class="link" href="#design-considerations-4">Design Considerations</a></h4>
<div class="paragraph">
<p><strong>Google Photos does not allow duplicate photos</strong>: Illustrated in the diagram below</p>
</div>
<div class="ulist">
<ul>
<li>
<p>No renaming of photos after upload allowed.</p>
</li>
<li>
<p>If an image is uploaded as "a.png", but exists with the exact same bytes as "b.png" on Google Photos, the image will replace the old image as b.png instead.</p>
</li>
<li>
<p>If two images with the same bytes are sent for upload, only the first will be uploaded.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/uploadExplanation.png" alt="uploadExplanation" width="800">
</div>
<div class="title">Figure 5. Illustrates when how Google Photos handles images</div>
</div>
<div class="paragraph">
<p>Currently the only measure taken has been to state this to the user. As this issue was only discovered in the later stages of development, it does not have a workaround yet. Though a lot of refactoring will be required,  switching from Google Photos to Google Drive might be a fix for the problem.</p>
</div>
</div>
</div>
</div>
</div></div><div id="footer"><div class="container"><div id="footer-text">Last updated 2018-11-16 14:59:59 UTC</div></div></div></body></html>